{
  "id": "guide/service-worker-getting-started",
  "title": "Service Worker 快速上手",
  "contents": "\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/angular/angular-cn/edit/cn/aio/content/guide/service-worker-getting-started.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <h1 id=\"getting-started-with-service-workers\">Getting started with service workers<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#getting-started-with-service-workers\"><i class=\"material-icons\">link</i></a></h1>\n<h1 id=\"service-worker-快速上手\">Service Worker 快速上手<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#service-worker-快速上手\"><i class=\"material-icons\">link</i></a></h1>\n<p>This document explains how to enable Angular service worker support in projects that you created with the <a href=\"cli\">Angular CLI</a>.\nIt then uses an example to show you a service worker in action, demonstrating loading and basic caching.</p>\n<p>本文档解释了如何在 <a href=\"cli\">Angular CLI</a> 项目中启用对 Angular Service Worker 的支持。稍后它会用一个简单的范例来向你展示 Service Worker 实践，包括加载和基础的缓存功能。</p>\n<h2 id=\"prerequisites\">Prerequisites<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#prerequisites\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"前提条件\">前提条件<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#前提条件\"><i class=\"material-icons\">link</i></a></h2>\n<p>A basic understanding of the information in <a href=\"guide/service-worker-intro\">Introduction to Angular service workers</a>.</p>\n<p>对 <a href=\"guide/service-worker-intro\">Angular Service Worker 简介</a>中的信息有了基本的了解。</p>\n<h2 id=\"adding-a-service-worker-to-your-project\">Adding a service worker to your project<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#adding-a-service-worker-to-your-project\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"为你的项目添加-service-worker\">为你的项目添加 Service Worker<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#为你的项目添加-service-worker\"><i class=\"material-icons\">link</i></a></h2>\n<p>To set up the Angular service worker in your project, use the CLI command <code>ng add @angular/pwa</code>.\nIt takes care of configuring your application to use service workers by adding the <code>@angular/service-worker</code> package along\nwith setting up the necessary support files.</p>\n<p>要让你的项目支持 Angular Service Worker，可以使用 CLI 命令 <code>ng add @angular/pwa</code>。它会添加 <code>@angular/service-worker</code> 包，并建立必要的支持文件，小心翼翼地配置你的应用，以便使用 Service Worker。</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng add @angular/pwa --project &#x3C;project-name>\n\n</code-example>\n<p>The preceding command completes the following actions:</p>\n<p>上述命令完成了如下步骤：</p>\n<ol>\n<li>\n<p>Adds the <code>@angular/service-worker</code> package to your project.</p>\n<p>把 @angular/service-worker 添加到你的项目中。</p>\n</li>\n<li>\n<p>Enables service worker build support in the CLI.</p>\n<p>在 CLI 中启用 Service Worker 的构建支持。</p>\n</li>\n<li>\n<p>Imports and registers the service worker in the application module.</p>\n<p>在应用模块中导入并注册 Service Worker。</p>\n</li>\n<li>\n<p>Updates the <code>index.html</code> file:</p>\n<p>修改 <code>index.html</code> 文件：</p>\n<ul>\n<li>\n<p>Includes a link to add the <code>manifest.webmanifest</code> file</p>\n<p>包含要添加到 <code>manifest.webmanifest</code> 文件中的链接。</p>\n</li>\n<li>\n<p>Adds a meta tag for <code>theme-color</code></p>\n<p>为 <code>theme-color</code> 添加 meta 标签。</p>\n</li>\n</ul>\n</li>\n<li>\n<p>Installs icon files to support the installed Progressive Web App (PWA).</p>\n<p>创建图标文件，以支持安装渐进式应用（PWA）。</p>\n</li>\n<li>\n<p>Creates the service worker configuration file called <a href=\"guide/service-worker-config\"><code>ngsw-config.json</code></a>, which specifies the caching behaviors and other settings.</p>\n<p>创建一个名叫 <a href=\"guide/service-worker-config\"><code>ngsw-config.json</code></a> 的 Service Worker 配置文件，它会用来指定缓存的行为以及其它设定。</p>\n<p>Now, build the project:</p>\n<p>现在，构建本项目：</p>\n</li>\n</ol>\n<code-example format=\"shell\" language=\"shell\">\n\nng build\n\n</code-example>\n<p>The CLI project is now set up to use the Angular service worker.</p>\n<p>现在，这个 CLI 项目就可以使用 Angular Service Worker 了。</p>\n<h2 id=\"service-worker-in-action-a-tour\">Service worker in action: a tour<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#service-worker-in-action-a-tour\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"service-worker-实战向导\">Service Worker 实战：向导<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#service-worker-实战向导\"><i class=\"material-icons\">link</i></a></h2>\n<p>This section demonstrates a service worker in action,\nusing an example application.</p>\n<p>本节用一个范例应用来演示一下 Service Worker 实战。</p>\n<h3 id=\"initial-load\">Initial load<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#initial-load\"><i class=\"material-icons\">link</i></a></h3>\n<h3 id=\"最初的加载\">最初的加载<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#最初的加载\"><i class=\"material-icons\">link</i></a></h3>\n<p>With the server running, point your browser at <code>http://localhost:8080</code>.\nYour application should load normally.</p>\n<p>在服务器运行起来之后，你可以在浏览器中访问 <code>&#x3C;http://localhost:8080/></code>。你的应用像通常一样加载。</p>\n<div class=\"alert is-helpful\">\n<p><strong>TIP</strong>: <br>\nWhen testing Angular service workers, it's a good idea to use an incognito or private window in your browser to ensure the service worker doesn't end up reading from a previous leftover state, which can cause unexpected behavior.</p>\n<p><strong>提示</strong>：<br>\n当测试 Angular Service Worker 时，最好使用浏览器中的隐身或隐私窗口，以确保 Service Worker 不会从以前的残留状态中读取数据，否则可能导致意外的行为。</p>\n</div>\n<div class=\"alert is-helpful\">\n<p><strong>NOTE</strong>: <br>\nIf you are not using HTTPS, the service worker will only be registered when accessing the application on <code>localhost</code>.</p>\n<p><strong>注意</strong>：<br>\n如果没有使用 HTTPS，那么 Service Worker 只会在 <code>localhost</code> 上的应用中进行注册。</p>\n</div>\n<h3 id=\"simulating-a-network-issue\">Simulating a network issue<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#simulating-a-network-issue\"><i class=\"material-icons\">link</i></a></h3>\n<h3 id=\"模拟网络出问题\">模拟网络出问题<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#模拟网络出问题\"><i class=\"material-icons\">link</i></a></h3>\n<p>To simulate a network issue, disable network interaction for your application.</p>\n<p>如果想模拟网络问题，以便在你的应用中禁用网络交互。</p>\n<p>In Chrome:</p>\n<p>在 Chrome 中：</p>\n<ol>\n<li>\n<p>Select <strong>Tools</strong> > <strong>Developer Tools</strong> (from the Chrome menu located in the top right corner).</p>\n<p>选择 <strong>Tools</strong> > <strong>Developer Tools</strong>（从右上角的 Chrome 菜单）。</p>\n</li>\n<li>\n<p>Go to the <strong>Network tab</strong>.</p>\n<p>进入 <strong>Network 页</strong>。</p>\n</li>\n<li>\n<p>Select <strong>Offline</strong> in the <strong>Throttling</strong> dropdown menu.</p>\n<p>在 <strong>Throttling</strong> 下拉菜单中选择 <strong>Offline</strong> 复选框。</p>\n</li>\n</ol>\n<div class=\"lightbox\">\n<img alt=\"The offline option in the Network tab is selected\" src=\"generated/images/guide/service-worker/offline-option.png\" width=\"910\" height=\"261\">\n</div>\n<p>Now the application has no access to network interaction.</p>\n<p>现在，本应用不能再和网络进行交互了。</p>\n<p>For applications that do not use the Angular service worker, refreshing now would display Chrome's Internet disconnected page that says \"There is no Internet connection\".</p>\n<p>对于那些不使用 Angular Service Worker 的应用，现在刷新将会显示 Chrome 的“网络中断”页，提示“没有可用的网络连接”。</p>\n<p>With the addition of an Angular service worker, the application behavior changes.\nOn a refresh, the page loads normally.</p>\n<p>有了 Angular Service Worker，本应用的行为就不一样了。刷新时，页面会正常加载。</p>\n<p>Look at the Network tab to verify that the service worker is active.</p>\n<p>看看 Network 页，来验证此 Service Worker 是激活的。</p>\n<div class=\"lightbox\">\n<img alt=\"Requests are marked as from ServiceWorker\" src=\"generated/images/guide/service-worker/sw-active.png\" width=\"1576\" height=\"170\">\n</div>\n<div class=\"alert is-helpful\">\n<p><strong>NOTE</strong>: <br>\nUnder the \"Size\" column, the requests state is <code>(ServiceWorker)</code>.\nThis means that the resources are not being loaded from the network.\nInstead, they are being loaded from the service worker's cache.</p>\n<p><strong>注意</strong>：<br>\n在 “Size” 列中，请求的状态是 <code>(ServiceWorker)</code>。\n这表示该资源不是从网络上加载的，而是从 Service Worker 的缓存中。</p>\n</div>\n<h3 id=\"whats-being-cached\">What's being cached?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#whats-being-cached\"><i class=\"material-icons\">link</i></a></h3>\n<h3 id=\"什么被缓存了\">什么被缓存了？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#什么被缓存了\"><i class=\"material-icons\">link</i></a></h3>\n<p>Notice that all of the files the browser needs to render this application are cached.\nThe <code>ngsw-config.json</code> boilerplate configuration is set up to cache the specific resources used by the CLI:</p>\n<p>注意，浏览器要渲染的所有这些文件都被缓存了。<code>ngsw-config.json</code> 样板文件被配置成了要缓存 CLI 用到的那些文件：</p>\n<ul>\n<li>\n<p><code>index.html</code></p>\n</li>\n<li>\n<p><code>favicon.ico</code></p>\n</li>\n<li>\n<p>Build artifacts (JS and CSS bundles)</p>\n<p>构建结果（JS 和 CSS 包）</p>\n</li>\n<li>\n<p>Anything under <code>assets</code></p>\n<p><code>assets</code> 下的一切</p>\n</li>\n<li>\n<p>Images and fonts directly under the configured <code>outputPath</code> (by default <code>./dist/&#x3C;project-name>/</code>) or <code>resourcesOutputPath</code>.\nSee <a href=\"cli/build\"><code>ng build</code></a> for more information about these options.</p>\n<p>图片和字体直接位于所配置的 <code>outputPath</code> (默认为 <code>./dist/&#x3C;project-name>/</code>) 或 <code>resourcesOutputPath</code> 下。关于这些配置的更多信息，请参阅 <a href=\"cli/build\"><code>ng build</code></a>。</p>\n</li>\n</ul>\n<div class=\"alert is-important\">\n<p>Pay attention to two key points:</p>\n<p>注意如下两个关键点：</p>\n<ol>\n<li>\n<p>The generated <code>ngsw-config.json</code> includes a limited list of cacheable fonts and images extensions.\nIn some cases, you might want to modify the glob pattern to suit your needs.</p>\n<p>所生成的 <code>ngsw-config.json</code> 包括一个可缓存字体和图像的有限列表。在某些情况下，你可能要按需修改这些 glob 模式。</p>\n</li>\n<li>\n<p>If <code>resourcesOutputPath</code> or <code>assets</code> paths are modified after the generation of configuration file, you need to change the paths manually in <code>ngsw-config.json</code>.</p>\n<p>如果在生成了配置文件之后修改了 <code>resourcesOutputPath</code> 或 <code>assets</code> 的路径，那么就要在 <code>ngsw-config.json</code> 中手动修改这些路径。</p>\n</li>\n</ol>\n</div>\n<h3 id=\"making-changes-to-your-application\">Making changes to your application<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#making-changes-to-your-application\"><i class=\"material-icons\">link</i></a></h3>\n<h3 id=\"修改你的应用\">修改你的应用<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#修改你的应用\"><i class=\"material-icons\">link</i></a></h3>\n<p>Now that you've seen how service workers cache your application, the next step is understanding how updates work.\nMake a change to the application, and watch the service worker install the update:</p>\n<p>现在，你已经看到了 Service Worker 如何缓存你的应用，接下来的步骤讲它如何进行更新。</p>\n<ol>\n<li>\n<p>If you're testing in an incognito window, open a second blank tab.\nThis keeps the incognito and the cache state alive during your test.</p>\n<p>如果你正在隐身窗口中测试，请打开第二个空白页。这会让该隐身窗口和缓存的状态在测试期间持续活着。</p>\n</li>\n<li>\n<p>Close the application tab, but not the window.\nThis should also close the Developer Tools.</p>\n<p>关闭该应用的页面，而不是整个窗口。这也会同时关闭开发者工具。</p>\n</li>\n<li>\n<p>Shut down <code>http-server</code>.</p>\n<p>关闭 <code>http-server</code>。</p>\n</li>\n<li>\n<p>Open <code>src/app/app.component.html</code> for editing.</p>\n<p>打开 <code>src/app/app.component.html</code> 以供编辑。</p>\n</li>\n<li>\n<p>Change the text <code>Welcome to {{title}}!</code> to <code>Bienvenue à {{title}}!</code>.</p>\n<p>把文本 <code>Welcome to {{title}}!</code> 改为 <code>Bienvenue à {{title}}!</code>。</p>\n</li>\n<li>\n<p>Build and run the server again:</p>\n<p>再次构建并运行此服务器：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng build\nhttp-server -p 8080 -c-1 dist/&#x3C;project-name>\n\n</code-example>\n</li>\n</ol>\n<h3 id=\"updating-your-application-in-the-browser\">Updating your application in the browser<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#updating-your-application-in-the-browser\"><i class=\"material-icons\">link</i></a></h3>\n<h3 id=\"在浏览器中更新你的应用\">在浏览器中更新你的应用<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#在浏览器中更新你的应用\"><i class=\"material-icons\">link</i></a></h3>\n<p>Now look at how the browser and service worker handle the updated application.</p>\n<p>现在，看看浏览器和 Service Worker 如何处理这个更新后的应用。</p>\n<ol>\n<li>\n<p>Open <a href=\"http://localhost:8080\">http://localhost:8080</a> again in the same window.\nWhat happens?</p>\n<p>再次在同一个窗口中打开 <a href=\"http://localhost:8080\">http://localhost:8080</a>，发生了什么？</p>\n<div class=\"lightbox\">\n<img alt=\"It still says Welcome to Service Workers!\" src=\"generated/images/guide/service-worker/welcome-msg-en.png\" width=\"411\" height=\"248\">\n</div>\n<p>What went wrong?\nNothing, actually.\nThe Angular service worker is doing its job and serving the version of the application that it has <strong>installed</strong>, even though there is an update available.\nIn the interest of speed, the service worker doesn't wait to check for updates before it serves the application that it has cached.</p>\n<p>错在哪里？哪里也没错，真的。Angular Service Worker 正在做自己的工作，并且用它<strong>已经安装过</strong>的版本提供服务，虽然，已经有新版本可用了。由于更关注速度，所以 Service Worker 并不会在启动它已经缓存过的版本之前先等待检查更新。</p>\n<p>Look at the <code>http-server</code> logs to see the service worker requesting <code>/ngsw.json</code>.\nThis is how the service worker checks for updates.</p>\n<p>看看 <code>http-server</code> 的 log，就会发现 Service Worker 请求了 <code>/ngsw.json</code> 文件，这是 Service Worker 正在检查更新。</p>\n</li>\n<li>\n<p>Refresh the page.</p>\n<p>刷新页面。</p>\n<div class=\"lightbox\">\n<img alt=\"The text has changed to say Bienvenue à app!\" src=\"generated/images/guide/service-worker/welcome-msg-fr.png\" width=\"393\" height=\"240\">\n</div>\n<p>The service worker installed the updated version of your application <em>in the background</em>, and the next time the page is loaded or reloaded, the service worker switches to the latest version.</p>\n<p>Service Worker <em>在后台</em>安装好了这个更新后的版本，下次加载或刷新页面时，Service Worker 就切换到最新的版本了。</p>\n</li>\n</ol>\n<h2 id=\"more-on-angular-service-workers\">More on Angular service workers<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#more-on-angular-service-workers\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"关于-angular-service-worker-的更多信息\">关于 Angular Service Worker 的更多信息<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/service-worker-getting-started#关于-angular-service-worker-的更多信息\"><i class=\"material-icons\">link</i></a></h2>\n<p>You might also be interested in the following:</p>\n<p>你可能还对下列内容感兴趣：</p>\n<ul>\n<li>\n<p><a href=\"guide/app-shell\">App Shell</a></p>\n<p><a href=\"guide/app-shell\">应用外壳</a></p>\n</li>\n<li>\n<p><a href=\"guide/service-worker-communications\">Communicating with service workers</a></p>\n<p><a href=\"guide/service-worker-communications\">与 Service Worker 通讯</a></p>\n</li>\n</ul>\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最后复查时间： 2/28/2022</div>\n</div>\n\n\n<!-- links to this doc:\n - guide/service-worker-communications\n - guide/service-worker-intro\n - guide/service-worker-notifications\n-->\n<!-- links from this doc:\n - cli\n - cli/build\n - guide/app-shell\n - guide/service-worker-communications\n - guide/service-worker-config\n - guide/service-worker-getting-started#adding-a-service-worker-to-your-project\n - guide/service-worker-getting-started#getting-started-with-service-workers\n - guide/service-worker-getting-started#initial-load\n - guide/service-worker-getting-started#making-changes-to-your-application\n - guide/service-worker-getting-started#more-on-angular-service-workers\n - guide/service-worker-getting-started#prerequisites\n - guide/service-worker-getting-started#service-worker-in-action-a-tour\n - guide/service-worker-getting-started#service-worker-实战向导\n - guide/service-worker-getting-started#service-worker-快速上手\n - guide/service-worker-getting-started#simulating-a-network-issue\n - guide/service-worker-getting-started#updating-your-application-in-the-browser\n - guide/service-worker-getting-started#whats-being-cached\n - guide/service-worker-getting-started#为你的项目添加-service-worker\n - guide/service-worker-getting-started#什么被缓存了\n - guide/service-worker-getting-started#修改你的应用\n - guide/service-worker-getting-started#关于-angular-service-worker-的更多信息\n - guide/service-worker-getting-started#前提条件\n - guide/service-worker-getting-started#在浏览器中更新你的应用\n - guide/service-worker-getting-started#最初的加载\n - guide/service-worker-getting-started#模拟网络出问题\n - guide/service-worker-intro\n - http://localhost:8080\n - https://github.com/angular/angular-cn/edit/cn/aio/content/guide/service-worker-getting-started.md?message=docs%3A%20请简述你的修改...\n-->"
}