{
  "id": "guide/testing",
  "title": "测试",
  "contents": "\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/angular/angular-cn/edit/cn/aio/content/guide/testing.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <p><a id=\"top\"></a></p>\n\n<h1 id=\"testing\">Testing<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#testing\"><i class=\"material-icons\">link</i></a></h1>\n<h1 id=\"测试\">测试<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#测试\"><i class=\"material-icons\">link</i></a></h1>\n<p>Testing your Angular application helps you check that your application is working as you expect.</p>\n<p>测试你的 Angular 应用可以帮助你检查此应用是否正常运行。</p>\n<h2 id=\"prerequisites\">Prerequisites<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#prerequisites\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"前提条件\">前提条件<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#前提条件\"><i class=\"material-icons\">link</i></a></h2>\n<p>Before writing tests for your Angular application, you should have a basic understanding of the following concepts:</p>\n<p>在为 Angular 应用编写测试之前，你应该对这些概念有一个基本的了解：</p>\n<ul>\n<li>\n<p><a href=\"guide/architecture\">Angular fundamentals</a></p>\n<p><a href=\"guide/architecture\">Angular 的基本原理</a></p>\n</li>\n<li>\n<p><a href=\"https://javascript.info/\">JavaScript</a></p>\n</li>\n<li>\n<p>HTML</p>\n</li>\n<li>\n<p>CSS</p>\n</li>\n<li>\n<p><a href=\"cli\">Angular CLI</a></p>\n</li>\n</ul>\n<p>The testing documentation offers tips and techniques for unit and integration testing Angular applications through a sample application created with the <a href=\"cli\">Angular CLI</a>.\nThis sample application is much like the one in the <a href=\"tutorial\"><em>Tour of Heroes</em> tutorial</a>.</p>\n<p>本测试文档通过使用 <a href=\"cli\">Angular CLI</a> 创建的范例应用，为对 Angular 应用进行单元测试和集成测试提供了技巧和方法。这个范例应用很像<a href=\"tutorial\"><em>“英雄之旅”</em>教程</a>中的应用。</p>\n<div class=\"alert is-helpful\">\n<p>If you'd like to experiment with the application that this guide describes, <live-example name=\"testing\" nodownload=\"\">run it in your browser</live-example> or <live-example name=\"testing\" downloadonly=\"\">download and run it locally</live-example>.</p>\n<p>如果你要试用本指南中所讲的应用，请<live-example name=\"testing\" nodownload=\"\">在浏览器中运行它</live-example>或<live-example name=\"testing\" downloadonly=\"\">下载并在本地运行它</live-example>。</p>\n</div>\n<p><a id=\"setup\"></a></p>\n<h2 id=\"set-up-testing\">Set up testing<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#set-up-testing\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"建立环境\">建立环境<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#建立环境\"><i class=\"material-icons\">link</i></a></h2>\n<p>The Angular CLI downloads and installs everything you need to test an Angular application with <a href=\"https://jasmine.github.io\">Jasmine testing framework</a>.</p>\n<p>Angular CLI 会下载并安装试用 <a href=\"https://jasmine.github.io\">Jasmine 测试框架</a> 测试 Angular 应用时所需的一切。</p>\n<p>The project you create with the CLI is immediately ready to test.\nJust run the <a href=\"cli/test\"><code>ng test</code></a> CLI command:</p>\n<p>你使用 CLI 创建的项目是可以立即用于测试的。运行 CLI 命令 <a href=\"cli/test\"><code>ng test</code></a> 即可：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng test\n\n</code-example>\n<p>The <code>ng test</code> command builds the application in <em>watch mode</em>,\nand launches the <a href=\"https://karma-runner.github.io\">Karma test runner</a>.</p>\n<p><code>ng test</code> 命令在<em>监视模式</em>下构建应用，并启动 <a href=\"https://karma-runner.github.io\">karma 测试运行器</a>。</p>\n<p>The console output looks the below:</p>\n<p>它的控制台输出一般是这样的：</p>\n<code-example format=\"shell\" language=\"shell\">\n\n02 11 2022 09:08:28.605:INFO [karma-server]: Karma v6.4.1 server started at http://localhost:9876/\n02 11 2022 09:08:28.607:INFO [launcher]: Launching browsers Chrome with concurrency unlimited\n02 11 2022 09:08:28.620:INFO [launcher]: Starting browser Chrome\n02 11 2022 09:08:31.312:INFO [Chrome]: Connected on socket -LaEYvD2R7MdcS0-AAAB with id 31534482\nChrome: Executed 3 of 3 SUCCESS (0.193 secs / 0.172 secs)\nTOTAL: 3 SUCCESS\n\n</code-example>\n<p>The last line of the log shows that Karma ran three tests that all passed.</p>\n<p>日志的最后一行显示 Karma 运行了三个测试，这些测试都通过了。</p>\n<p>The test output is displayed in the browser using <a href=\"https://github.com/dfederm/karma-jasmine-html-reporter\">Karma Jasmine HTML Reporter</a>.</p>\n<p>测试输出使用 <a href=\"https://github.com/dfederm/karma-jasmine-html-reporter\">Karma Jasmine HTML Reporter</a> 显示在浏览器中。</p>\n<div class=\"lightbox\">\n<img alt=\"Jasmine HTML Reporter in the browser\" src=\"generated/images/guide/testing/initial-jasmine-html-reporter.png\" width=\"502\" height=\"306\">\n</div>\n<p>Click on a test row to re-run just that test or click on a description to re-run the tests in the selected test group (\"test suite\").</p>\n<p>可以点击某一行测试，来单独重跑这个测试，或者点击一行描述信息来重跑所选测试组（“测试套件”）中的那些测试。</p>\n<p>Meanwhile, the <code>ng test</code> command is watching for changes.</p>\n<p>同时，<code>ng test</code> 命令还会监听这些变化。</p>\n<p>To see this in action, make a small change to <code>app.component.ts</code> and save.\nThe tests run again, the browser refreshes, and the new test results appear.</p>\n<p>要查看它的实际效果，就对 <code>app.component.ts</code> 做一个小修改，并保存它。这些测试就会重新运行，浏览器也会刷新，然后新的测试结果就出现了。</p>\n<h2 id=\"configuration\">Configuration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#configuration\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"配置\">配置<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#配置\"><i class=\"material-icons\">link</i></a></h2>\n<p>The Angular CLI takes care of Jasmine and Karma configuration for you. It constructs the full configuration in memory, based on options specified in the <code>angular.json</code> file.</p>\n<p>Angular CLI 会为你处理 Jasmine 和 Karma 配置。它根据 <code>angular.json</code> 文件中指定的选项在内存中构建完整配置。</p>\n<p>If you require to fine-tune Karma, follow the below steps:</p>\n<p>如果你需要微调 Karma，请按照以下步骤操作：</p>\n<ol>\n<li>\n<p>Create a <code>karma.conf.js</code> in the root folder of the project.</p>\n<p>在项目的根文件夹中创建一个 <code>karma.conf.js</code> 。</p>\n<code-example format=\"javascript\" language=\"javascript\" header=\"karma.conf.js\">\n\nmodule.exports = function (config) {\n  config.set({\n    basePath: '',\n    frameworks: ['jasmine', '@angular-devkit/build-angular'],\n    plugins: [\n      require('karma-jasmine'),\n      require('karma-chrome-launcher'),\n      require('karma-jasmine-html-reporter'),\n      require('karma-coverage'),\n      require('@angular-devkit/build-angular/plugins/karma')\n    ],\n    client: {\n      jasmine: {\n        // you can add configuration options for Jasmine here\n        // the possible options are listed at https://jasmine.github.io/api/edge/Configuration.html\n        // for example, you can disable the random execution with `random: false`\n        // or set a specific seed with `seed: 4321`\n      },\n      clearContext: false // leave Jasmine Spec Runner output visible in <a href=\"api/animations/browser\" class=\"code-anchor\">browser</a>\n    },\n    jasmineHtmlReporter: {\n      suppressAll: true // removes the duplicated traces\n    },\n    coverageReporter: {\n      dir: require('path').join(__dirname, './coverage/<project-name>'),\n      subdir: '.',\n      reporters: [\n        { type: 'html' },\n        { type: 'text-summary' }\n      ]\n    },\n    reporters: ['progress', 'kjhtml'],\n    port: 9876,\n    colors: true,\n    logLevel: config.LOG_INFO,\n    autoWatch: true,\n    browsers: ['Chrome'],\n    singleRun: false,\n    restartOnFileChange: true\n  });\n};\n\n</project-name></code-example>\n</li>\n<li>\n<p>In the <code>angular.json</code>, use the <a href=\"cli/test\"><code>karmaConfig</code></a> option to configure the Karma builder to use the created configuration file.</p>\n<p>在 <code>angular.json</code> 中，使用 <a href=\"cli/test\"><code>karmaConfig</code></a> 选项将 Karma 构建器配置为使用创建的配置文件。</p>\n<code-example format=\"jsonc\" language=\"jsonc\">\n\n\"test\": {\n  \"builder\": \"@angular-devkit/build-angular:karma\",\n  \"options\": {\n    \"karmaConfig\": \"karma.conf.js\",\n    \"polyfills\": [\"zone.js\", \"zone.js/testing\"],\n    \"tsConfig\": \"src/tsconfig.spec.json\",\n    \"styles\": [\"src/styles.css\"]\n  }\n}\n\n</code-example>\n</li>\n</ol>\n<div class=\"alert is-helpful\">\n<p>Read more about Karma configuration in the <a href=\"http://karma-runner.github.io/6.4/config/configuration-file.html\">Karma configuration guide</a>.</p>\n<p>要了解更多关于 Karma 配置的信息，参见 <a href=\"http://karma-runner.github.io/6.4/config/configuration-file.html\">Karma 配置指南</a>。</p>\n</div>\n<h3 id=\"other-test-frameworks\">Other test frameworks<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#other-test-frameworks\"><i class=\"material-icons\">link</i></a></h3>\n<h3 id=\"其他测试框架\">其他测试框架<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#其他测试框架\"><i class=\"material-icons\">link</i></a></h3>\n<p>You can also unit test an Angular application with other testing libraries and test runners.\nEach library and runner has its own distinctive installation procedures, configuration, and syntax.</p>\n<p>你还可以使用其它的测试库和测试运行器来对 Angular 应用进行单元测试。每个库和运行器都有自己特有的安装过程、配置项和语法。</p>\n<h3 id=\"test-file-name-and-location\">Test file name and location<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#test-file-name-and-location\"><i class=\"material-icons\">link</i></a></h3>\n<h3 id=\"测试文件名及其位置\">测试文件名及其位置<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#测试文件名及其位置\"><i class=\"material-icons\">link</i></a></h3>\n<p>Inside the <code>src/app</code> folder the Angular CLI generated a test file for the <code>AppComponent</code> named <code>app.component.spec.ts</code>.</p>\n<p>在 <code>src/app</code> 目录中，CLI 为 <code>AppComponent</code> 生成了一个名叫 <code>app.component.spec.ts</code> 的测试文件。</p>\n<div class=\"alert is-important\">\n<p>The test file extension <strong>must be <code>.spec.ts</code></strong> so that tooling can identify it as a file with tests (also known as a <em>spec</em> file).</p>\n<p>测试文件的扩展名<strong>必须是 <code>.spec.ts</code></strong>，这样工具才能识别出它是一个测试文件，也叫规约（spec）文件。</p>\n</div>\n<p>The <code>app.component.ts</code> and <code>app.component.spec.ts</code> files are siblings in the same folder.\nThe root file names (<code>app.component</code>) are the same for both files.</p>\n<p><code>app.component.ts</code> 和 <code>app.component.spec.ts</code> 文件位于同一个文件夹中，而且相邻。其根文件名部分（<code>app.component</code>）都是一样的。</p>\n<p>Adopt these two conventions in your own projects for <em>every kind</em> of test file.</p>\n<p>请在你的项目中对<em>任意类型</em>的测试文件都坚持这两条约定。</p>\n<p><a id=\"q-spec-file-location\"></a></p>\n<h4 id=\"place-your-spec-file-next-to-the-file-it-tests\">Place your spec file next to the file it tests<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#place-your-spec-file-next-to-the-file-it-tests\"><i class=\"material-icons\">link</i></a></h4>\n<h4 id=\"把测试规约spec文件放在它要测试的文件旁边\">把测试规约（spec）文件放在它要测试的文件旁边<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#把测试规约spec文件放在它要测试的文件旁边\"><i class=\"material-icons\">link</i></a></h4>\n<p>It's a good idea to put unit test spec files in the same folder\nas the application source code files that they test:</p>\n<p>最好把单元测试规约文件放到与它们测试的应用源码文件相同的文件夹中：</p>\n<ul>\n<li>\n<p>Such tests are painless to find</p>\n<p>这些测试很容易找到。</p>\n</li>\n<li>\n<p>You see at a glance if a part of your application lacks tests</p>\n<p>你一眼就能看到应用中是否缺少一些测试。</p>\n</li>\n<li>\n<p>Nearby tests can reveal how a part works in context</p>\n<p>临近的测试可以揭示一个部件会如何在上下文中工作。</p>\n</li>\n<li>\n<p>When you move the source (inevitable), you remember to move the test</p>\n<p>当移动源代码时（在所难免），你不会忘了同时移动测试。</p>\n</li>\n<li>\n<p>When you rename the source file (inevitable), you remember to rename the test file</p>\n<p>当重命名源文件时（在所难免），你不会忘了重命名测试文件。</p>\n</li>\n</ul>\n<p><a id=\"q-specs-in-test-folder\"></a></p>\n<h4 id=\"place-your-spec-files-in-a-test-folder\">Place your spec files in a test folder<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#place-your-spec-files-in-a-test-folder\"><i class=\"material-icons\">link</i></a></h4>\n<h4 id=\"把-spec-文件放到-test-目录下\">把 spec 文件放到 test 目录下<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#把-spec-文件放到-test-目录下\"><i class=\"material-icons\">link</i></a></h4>\n<p>Application integration specs can test the interactions of multiple parts\nspread across folders and modules.\nThey don't really belong to any part in particular, so they don't have a\nnatural home next to any one file.</p>\n<p>应用的集成测试规范可以测试跨文件夹和模块的多个部分之间的交互。它们并不属于任何一个特定的部分，所以把它们放在任何一个文件旁都很不自然。</p>\n<p>It's often better to create an appropriate folder for them in the <code>tests</code> directory.</p>\n<p>最好在 <code>tests</code> 目录下为它们创建一个合适的文件夹。</p>\n<p>Of course specs that test the test helpers belong in the <code>test</code> folder,\nnext to their corresponding helper files.</p>\n<p>当然，用来测试那些测试助手的规约也位于 <code>test</code> 目录下，紧挨着相应的测试助手文件。</p>\n<p><a id=\"ci\"></a></p>\n<h2 id=\"testing-in-continuous-integration\">Testing in continuous integration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#testing-in-continuous-integration\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"建立持续集成环境\">建立持续集成环境<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#建立持续集成环境\"><i class=\"material-icons\">link</i></a></h2>\n<p>One of the best ways to keep your project bug-free is through a test suite, but you might forget to run tests all the time.</p>\n<p>保持项目无错误的最佳方法之一是通过测试套件，但你可能会忘记一直运行测试。</p>\n<p>Continuous integration (CI) servers let you set up your project repository so that your tests run on every commit and pull request.</p>\n<p>避免项目出 BUG 的最佳方式之一，就是使用测试套件。但是很容易忘了一直运行它。持续集成（CI）服务器让你可以配置项目的代码仓库，以便每次提交和收到 Pull Request 时就会运行你的测试。</p>\n<p>To test your Angular CLI application in Continuous integration (CI) run the following command:</p>\n<p>要在持续集成 (CI) 中测试你的 Angular CLI 应用程序，请运行以下命令：</p>\n<code-example format=\"shell\" language=\"shell\">\n\nng test --no-watch --no-progress\n\n</code-example>\n<h2 id=\"more-information-on-testing\">More information on testing<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#more-information-on-testing\"><i class=\"material-icons\">link</i></a></h2>\n<h2 id=\"关于测试的更多信息\">关于测试的更多信息<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/testing#关于测试的更多信息\"><i class=\"material-icons\">link</i></a></h2>\n<p>After you've set up your application for testing, you might find the following testing guides useful.</p>\n<p>当你设置准备好测试环境之后，可能会发现以下测试指南很有用。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th align=\"left\">Details</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\"></td>\n<td align=\"left\">详情</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-code-coverage\">Code coverage</a></td>\n<td align=\"left\">How much of your app your tests are covering and how to specify required amounts.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-code-coverage\">代码覆盖</a></td>\n<td align=\"left\">找出你的测试覆盖了多少应用，以及如何指定所需的数量。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-services\">Testing services</a></td>\n<td align=\"left\">How to test the services your application uses.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-services\">测试服务</a></td>\n<td align=\"left\">如何测试应用中所用的服务。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-components-basics\">Basics of testing components</a></td>\n<td align=\"left\">Basics of testing Angular components.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-components-basics\">测试组件的基础知识</a></td>\n<td align=\"left\">测试 Angular 组件的基础知识。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-components-scenarios\">Component testing scenarios</a></td>\n<td align=\"left\">Various kinds of component testing scenarios and use cases.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-components-scenarios\">组件测试场景</a></td>\n<td align=\"left\">了解各种组件测试场景和用例。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-attribute-directives\">Testing attribute directives</a></td>\n<td align=\"left\">How to test your attribute directives.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-attribute-directives\">测试属性型指令</a></td>\n<td align=\"left\">如何测试你的属性型指令。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-pipes\">Testing pipes</a></td>\n<td align=\"left\">How to test pipes.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-pipes\">测试管道</a></td>\n<td align=\"left\">如何测试管道。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/test-debugging\">Debugging tests</a></td>\n<td align=\"left\">Common testing bugs.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/test-debugging\">调试测试代码</a></td>\n<td align=\"left\">发现测试代码的常见 BUG。</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-utility-apis\">Testing utility APIs</a></td>\n<td align=\"left\">Angular testing features.</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"guide/testing-utility-apis\">测试实用工具 API</a></td>\n<td align=\"left\">Angular 的测试特性。</td>\n</tr>\n</tbody>\n</table>\n<!-- links -->\n<!-- external links -->\n<!-- end links -->\n\n  <div class=\"reviewed\">最后复查时间： 11/2/2022</div>\n</div>\n\n\n<!-- links to this doc:\n - guide/architecture-next-steps\n - guide/developer-guide-overview\n - guide/docs-style-guide\n - guide/example-apps-list\n - guide/test-debugging\n - guide/testing-utility-apis\n - tutorial/toh-pt0\n-->\n<!-- links from this doc:\n - api/animations/browser\n - cli\n - cli/test\n - guide/architecture\n - guide/test-debugging\n - guide/testing#configuration\n - guide/testing#more-information-on-testing\n - guide/testing#other-test-frameworks\n - guide/testing#place-your-spec-file-next-to-the-file-it-tests\n - guide/testing#place-your-spec-files-in-a-test-folder\n - guide/testing#prerequisites\n - guide/testing#set-up-testing\n - guide/testing#test-file-name-and-location\n - guide/testing#testing\n - guide/testing#testing-in-continuous-integration\n - guide/testing#关于测试的更多信息\n - guide/testing#其他测试框架\n - guide/testing#前提条件\n - guide/testing#建立持续集成环境\n - guide/testing#建立环境\n - guide/testing#把-spec-文件放到-test-目录下\n - guide/testing#把测试规约spec文件放在它要测试的文件旁边\n - guide/testing#测试\n - guide/testing#测试文件名及其位置\n - guide/testing#配置\n - guide/testing-attribute-directives\n - guide/testing-code-coverage\n - guide/testing-components-basics\n - guide/testing-components-scenarios\n - guide/testing-pipes\n - guide/testing-services\n - guide/testing-utility-apis\n - tutorial\n - http://karma-runner.github.io/6.4/config/configuration-file.html\n - https://github.com/angular/angular-cn/edit/cn/aio/content/guide/testing.md?message=docs%3A%20请简述你的修改...\n - https://github.com/dfederm/karma-jasmine-html-reporter\n - https://jasmine.github.io\n - https://javascript.info/\n - https://karma-runner.github.io\n-->"
}