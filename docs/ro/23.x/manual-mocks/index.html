<!DOCTYPE html><html lang="ro"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Manual Mocks · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Mock-urile manuale sunt folosite pentru a înlocui funcţionalități cu date mock. De exemplu, în loc să accesați o resursă din rețea precum un site sau o bază de date, aţi putea dori să creați un mock manual care vă permite să utilizaţi date false. Acest lucru asigură că testele vor fi rapide şi nu fragile."/><meta name="docsearch:version" content="23.x"/><meta name="docsearch:language" content="ro"/><meta property="og:title" content="Manual Mocks · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jestjs.io/"/><meta property="og:description" content="Mock-urile manuale sunt folosite pentru a înlocui funcţionalități cu date mock. De exemplu, în loc să accesați o resursă din rețea precum un site sau o bază de date, aţi putea dori să creați un mock manual care vă permite să utilizaţi date false. Acest lucru asigură că testele vor fi rapide şi nu fragile."/><meta property="og:image" content="https://jestjs.io/img/opengraph.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://jestjs.io/img/jest.png"/><link rel="shortcut icon" href="/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://jestjs.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://jestjs.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/ro"><img class="logo" src="/img/jest.svg" alt="Jest"/><h2 class="headerTitleWithLogo">Jest</h2></a><a href="/ro/versions"><h3>23.x</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/ro/23.x/getting-started" target="_self">Documentație</a></li><li class="siteNavGroupActive"><a href="/docs/ro/23.x/api" target="_self">API</a></li><li class=""><a href="/ro/help" target="_self">Ajutor</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>Română</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/23.x/manual-mocks">English</a></li><li><a href="/docs/ja/23.x/manual-mocks">日本語</a></li><li><a href="/docs/es-ES/23.x/manual-mocks">Español</a></li><li><a href="/docs/pt-BR/23.x/manual-mocks">Português (Brasil)</a></li><li><a href="/docs/ru/23.x/manual-mocks">Русский</a></li><li><a href="/docs/uk/23.x/manual-mocks">Українська</a></li><li><a href="/docs/zh-Hans/23.x/manual-mocks">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/using-matchers">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/asynchronous">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/setup-teardown">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/mock-functions">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/jest-platform">Jest Platform</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/jest-community">Jest Community</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/more-resources">More Resources</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/snapshot-testing">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/tutorial-async">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/timer-mocks">Timer Mocks</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/ro/23.x/manual-mocks">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/es6-class-mocks">ES6 Class Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/bypassing-module-mocks">Bypassing module mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/webpack">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/puppeteer">Using with puppeteer</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/mongodb">Using with MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/tutorial-jquery">DOM Manipulation</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/watch-plugins">Watch Plugins</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/migration-guide">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/troubleshooting">Troubleshooting</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Framework Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/tutorial-react">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/tutorial-react-native">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/testing-frameworks">Testing Web Frameworks</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/api">Globals</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/expect">Expect</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/mock-function-api">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/jest-object">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/configuration">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/ro/23.x/cli">Jest CLI Options</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/jest/edit/master/docs/ManualMocks.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Manual Mocks</h1></header><article><div><span><p>Mock-urile manuale sunt folosite pentru a înlocui funcţionalități cu date mock. De exemplu, în loc să accesați o resursă din rețea precum un site sau o bază de date, aţi putea dori să creați un mock manual care vă permite să utilizaţi date false. Acest lucru asigură că testele vor fi rapide şi nu fragile.</p>
<h2><a class="anchor" aria-hidden="true" id="mocking-user-modules"></a><a href="#mocking-user-modules" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocking user modules</h2>
<p>Mock-urile manuale sunt definite prin crearea unui modul în subdirectorul <code>__mocks__ /</code> imediat adiacent modulului. De exemplu, pentru crea un mock pentru un modul numit <code>user</code> în directorul <code>models</code>, creaţi un fişier numit <code>user.js</code> şi puneți-l în directorul <code>models/__mocks__</code>. Reţineţi că folderul <code>__mocks__</code> este case-sensitive, astfel încât denumirea <code>__MOCKS__</code> nu va funcționa pe unele sisteme.</p>
<blockquote>
<p>When we require that module in our tests, explicitly calling <code>jest.mock('./moduleName')</code> is <strong>required</strong>.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="mocking-node-modules"></a><a href="#mocking-node-modules" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocking Node modules</h2>
<p>If the module you are mocking is a Node module (e.g.: <code>lodash</code>), the mock should be placed in the <code>__mocks__</code> directory adjacent to <code>node_modules</code> (unless you configured <a href="/docs/ro/23.x/configuration#roots-arraystring"><code>roots</code></a> to point to a folder other than the project root) and will be <strong>automatically</strong> mocked. There's no need to explicitly call <code>jest.mock('module_name')</code>.</p>
<p>Scoped modules can be mocked by creating a file in a directory structure that matches the name of the scoped module. For example, to mock a scoped module called <code>@scope/project-name</code>, create a file at <code>__mocks__/@scope/project-name.js</code>, creating the <code>@scope/</code> directory accordingly.</p>
<blockquote>
<p>Warning: If we want to mock Node's core modules (e.g.: <code>fs</code> or <code>path</code>), then explicitly calling e.g. <code>jest.mock('path')</code> is <strong>required</strong>, because core Node modules are not mocked by default.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="exemple"></a><a href="#exemple" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exemple</h2>
<pre><code class="hljs css language-bash">.
├── config
├── __mocks__
│   └── fs.js
├── models
│   ├── __mocks__
│   │   └── user.js
│   └── user.js
├── node_modules
└── views
</code></pre>
<p>Atunci când un mock manual există pentru un anumit modul, sistemul de module din Jest va utiliza acel modul când apelați explicit <code>jest.mock('moduleName')</code>. However, when <code>automock</code> is set to <code>true</code>, the manual mock implementation will be used instead of the automatically created mock, even if <code>jest.mock('moduleName')</code> is not called. Pentru a renunţa la acest comportament trebuie să apelați explicit <code>jest.unmock('moduleName')</code> în testele care ar trebui să utilizeze implementarea reală a modulului.</p>
<blockquote>
<p>Note: In order to mock properly, Jest needs <code>jest.mock('moduleName')</code> to be in the same scope as the <code>require/import</code> statement.</p>
</blockquote>
<p>Here's a contrived example where we have a module that provides a summary of all the files in a given directory. In this case we use the core (built in) <code>fs</code> module.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// FileSummarizer.js</span>
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">summarizeFilesInDirectorySync</span>(<span class="hljs-params">directory</span>) </span>{
  <span class="hljs-keyword">return</span> fs.readdirSync(directory).map(<span class="hljs-function"><span class="hljs-params">fileName</span> =&gt;</span> ({
    directory,
    fileName,
  }));
}

exports.summarizeFilesInDirectorySync = summarizeFilesInDirectorySync;
</code></pre>
<p>Since we'd like our tests to avoid actually hitting the disk (that's pretty slow and fragile), we create a manual mock for the <code>fs</code> module by extending an automatic mock. Our manual mock will implement custom versions of the <code>fs</code> APIs that we can build on for our tests:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// __mocks__/fs.js</span>
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-keyword">const</span> fs = jest.genMockFromModule(<span class="hljs-string">'fs'</span>);

<span class="hljs-comment">// This is a custom function that our tests can use during setup to specify</span>
<span class="hljs-comment">// what the files on the "mock" filesystem should look like when any of the</span>
<span class="hljs-comment">// `fs` APIs are used.</span>
<span class="hljs-keyword">let</span> mockFiles = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__setMockFiles</span>(<span class="hljs-params">newMockFiles</span>) </span>{
  mockFiles = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> file <span class="hljs-keyword">in</span> newMockFiles) {
    <span class="hljs-keyword">const</span> dir = path.dirname(file);

    <span class="hljs-keyword">if</span> (!mockFiles[dir]) {
      mockFiles[dir] = [];
    }
    mockFiles[dir].push(path.basename(file));
  }
}

<span class="hljs-comment">// A custom version of `readdirSync` that reads from the special mocked out</span>
<span class="hljs-comment">// file list set via __setMockFiles</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readdirSync</span>(<span class="hljs-params">directoryPath</span>) </span>{
  <span class="hljs-keyword">return</span> mockFiles[directoryPath] || [];
}

fs.__setMockFiles = __setMockFiles;
fs.readdirSync = readdirSync;

<span class="hljs-built_in">module</span>.exports = fs;
</code></pre>
<p>Acum vom scrie testul nostru. Note that we need to explicitly tell that we want to mock the <code>fs</code> module because it’s a core Node module:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// __tests__/FileSummarizer-test.js</span>
<span class="hljs-meta">'use strict'</span>;

jest.mock(<span class="hljs-string">'fs'</span>);

describe(<span class="hljs-string">'listFilesInDirectorySync'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> MOCK_FILE_INFO = {
    <span class="hljs-string">'/path/to/file1.js'</span>: <span class="hljs-string">'console.log("file1 contents");'</span>,
    <span class="hljs-string">'/path/to/file2.txt'</span>: <span class="hljs-string">'file2 contents'</span>,
  };

  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Set up some mocked out file info before each test</span>
    <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>).__setMockFiles(MOCK_FILE_INFO);
  });

  test(<span class="hljs-string">'includes all files in the directory in the summary'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> FileSummarizer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../FileSummarizer'</span>);
    <span class="hljs-keyword">const</span> fileSummary = FileSummarizer.summarizeFilesInDirectorySync(
      <span class="hljs-string">'/path/to'</span>,
    );

    expect(fileSummary.length).toBe(<span class="hljs-number">2</span>);
  });
});
</code></pre>
<p>The example mock shown here uses <a href="/docs/ro/23.x/jest-object#jestgenmockfrommodulemodulename"><code>jest.genMockFromModule</code></a> to generate an automatic mock, and overrides its default behavior. This is the recommended approach, but is completely optional. If you do not want to use the automatic mock at all, you can export your own functions from the mock file. One downside to fully manual mocks is that they're manual – meaning you have to manually update them any time the module they are mocking changes. Because of this, it's best to use or extend the automatic mock when it works for your needs.</p>
<p>To ensure that a manual mock and its real implementation stay in sync, it might be useful to require the real module using <a href="/docs/ro/23.x/jest-object#jestrequireactualmodulename"><code>jest.requireActual(moduleName)</code></a> in your manual mock and amending it with mock functions before exporting it.</p>
<p>The code for this example is available at <a href="https://github.com/facebook/jest/tree/master/examples/manual-mocks">examples/manual-mocks</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="folosirea-cu-importurile-modulelor-es"></a><a href="#folosirea-cu-importurile-modulelor-es" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Folosirea cu importurile modulelor ES</h2>
<p>If you're using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">ES module imports</a> then you'll normally be inclined to put your <code>import</code> statements at the top of the test file. But often you need to instruct Jest to use a mock before modules use it. For this reason, Jest will automatically hoist <code>jest.mock</code> calls to the top of the module (before any imports). To learn more about this and see it in action, see <a href="https://github.com/kentcdodds/how-jest-mocking-works">this repo</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="mocking-methods-which-are-not-implemented-in-jsdom"></a><a href="#mocking-methods-which-are-not-implemented-in-jsdom" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocking methods which are not implemented in JSDOM</h2>
<p>If some code uses a method which JSDOM (the DOM implementation used by Jest) hasn't implemented yet, testing it is not easily possible. This is e.g. the case with <code>window.matchMedia()</code>. Jest returns <code>TypeError: window.matchMedia is not a function</code> and doesn't properly execute the test.</p>
<p>In this case, mocking <code>matchMedia</code> in the test file should solve the issue:</p>
<pre><code class="hljs css language-js"><span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-built_in">window</span>, <span class="hljs-string">'matchMedia'</span>, {
  <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">value</span>: jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">query</span> =&gt;</span> ({
    <span class="hljs-attr">matches</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">media</span>: query,
    <span class="hljs-attr">onchange</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">addListener</span>: jest.fn(), <span class="hljs-comment">// deprecated</span>
    <span class="hljs-attr">removeListener</span>: jest.fn(), <span class="hljs-comment">// deprecated</span>
    <span class="hljs-attr">addEventListener</span>: jest.fn(),
    <span class="hljs-attr">removeEventListener</span>: jest.fn(),
    <span class="hljs-attr">dispatchEvent</span>: jest.fn(),
  })),
});
</code></pre>
<p>This works if <code>window.matchMedia()</code> is used in a function (or method) which is invoked in the test. If <code>window.matchMedia()</code> is executed directly in the tested file, Jest reports the same error. In this case, the solution is to move the manual mock into a separate file and include this one in the test <strong>before</strong> the tested file:</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> <span class="hljs-string">'./matchMedia.mock'</span>; <span class="hljs-comment">// Must be imported before the tested file</span>
<span class="hljs-keyword">import</span> {myMethod} <span class="hljs-keyword">from</span> <span class="hljs-string">'./file-to-test'</span>;

describe(<span class="hljs-string">'myMethod()'</span>, () =&gt; {
  <span class="hljs-comment">// Test the method here...</span>
});
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ro/23.x/timer-mocks"><span class="arrow-prev">← </span><span>Timer Mocks</span></a><a class="docs-next button" href="/docs/ro/23.x/es6-class-mocks"><span>ES6 Class Mocks</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#mocking-user-modules">Mocking user modules</a></li><li><a href="#mocking-node-modules">Mocking Node modules</a></li><li><a href="#exemple">Exemple</a></li><li><a href="#folosirea-cu-importurile-modulelor-es">Folosirea cu importurile modulelor ES</a></li><li><a href="#mocking-methods-which-are-not-implemented-in-jsdom">Mocking methods which are not implemented in JSDOM</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/ro/getting-started.html">Getting Started</a><a href="/docs/ro/snapshot-testing.html">Guides</a><a href="/docs/ro/api.html">API Reference</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://www.reactiflux.com/">Reactiflux</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/jest on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:ro","version:23.x"]}
              });
            </script></body></html>