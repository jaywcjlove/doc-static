<!DOCTYPE html><html lang="zh-Hans"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Using with webpack · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Jest 可以用于使用 [webpack](https://webpack.js.org/) 来管理资源、 样式和编译的项目中。 webpack *确实* 相比超过其他类似工具来说，展示出一些特有的优势，因为它直接与你的app整合，允许管理资源文件，如图像和字体，并带有可以将系统编译为JavaScript 语言和工具。"/><meta name="docsearch:version" content="23.x"/><meta name="docsearch:language" content="zh-Hans"/><meta property="og:title" content="Using with webpack · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jestjs.io/"/><meta property="og:description" content="Jest 可以用于使用 [webpack](https://webpack.js.org/) 来管理资源、 样式和编译的项目中。 webpack *确实* 相比超过其他类似工具来说，展示出一些特有的优势，因为它直接与你的app整合，允许管理资源文件，如图像和字体，并带有可以将系统编译为JavaScript 语言和工具。"/><meta property="og:image" content="https://jestjs.io/img/opengraph.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://jestjs.io/img/jest.png"/><link rel="shortcut icon" href="/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://jestjs.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://jestjs.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-Hans"><img class="logo" src="/img/jest.svg" alt="Jest"/><h2 class="headerTitleWithLogo">Jest</h2></a><a href="/zh-Hans/versions"><h3>23.x</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/zh-Hans/23.x/getting-started" target="_self">文档</a></li><li class="siteNavGroupActive"><a href="/docs/zh-Hans/23.x/api" target="_self">API</a></li><li class=""><a href="/zh-Hans/help" target="_self">帮助</a></li><li class=""><a href="/blog/" target="_self">博客</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>简体中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/23.x/webpack">English</a></li><li><a href="/docs/ja/23.x/webpack">日本語</a></li><li><a href="/docs/es-ES/23.x/webpack">Español</a></li><li><a href="/docs/pt-BR/23.x/webpack">Português (Brasil)</a></li><li><a href="/docs/ro/23.x/webpack">Română</a></li><li><a href="/docs/ru/23.x/webpack">Русский</a></li><li><a href="/docs/uk/23.x/webpack">Українська</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/using-matchers">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/asynchronous">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/setup-teardown">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/mock-functions">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/jest-platform">Jest Platform</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/jest-community">Jest Community</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/more-resources">More Resources</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/snapshot-testing">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/tutorial-async">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/timer-mocks">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/manual-mocks">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/es6-class-mocks">ES6 Class Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/bypassing-module-mocks">Bypassing module mocks</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/zh-Hans/23.x/webpack">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/puppeteer">Using with puppeteer</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/mongodb">Using with MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/tutorial-jquery">DOM Manipulation</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/watch-plugins">Watch Plugins</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/migration-guide">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/troubleshooting">Troubleshooting</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">框架指南</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/tutorial-react">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/tutorial-react-native">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/testing-frameworks">Testing Web Frameworks</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/api">Globals</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/expect">Expect</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/mock-function-api">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/jest-object">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/configuration">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/23.x/cli">Jest CLI Options</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/jest/edit/master/docs/Webpack.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Using with webpack</h1></header><article><div><span><p>Jest 可以用于使用 <a href="https://webpack.js.org/">webpack</a> 来管理资源、 样式和编译的项目中。 webpack <em>确实</em> 相比超过其他类似工具来说，展示出一些特有的优势，因为它直接与你的app整合，允许管理资源文件，如图像和字体，并带有可以将系统编译为JavaScript 语言和工具。</p>
<h2><a class="anchor" aria-hidden="true" id="webpack-示例"></a><a href="#webpack-示例" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Webpack 示例</h2>
<p>我们通过以下常见的webpack 配置文件，将其转化为符合Jest使用的配置。</p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">loaders</span>: [
      {<span class="hljs-attr">exclude</span>: [<span class="hljs-string">'node_modules'</span>], <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jsx?$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'style-loader!css-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'url-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.gif$/</span>},
      {<span class="hljs-attr">loader</span>: <span class="hljs-string">'file-loader'</span>, <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|eot|svg)$/</span>},
    ],
  },
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-attr">config$</span>: <span class="hljs-string">'./configs/app-config.js'</span>,
      <span class="hljs-attr">react</span>: <span class="hljs-string">'./vendor/react-master'</span>,
    },
    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">''</span>, <span class="hljs-string">'js'</span>, <span class="hljs-string">'jsx'</span>],
    <span class="hljs-attr">modules</span>: [
      <span class="hljs-string">'node_modules'</span>,
      <span class="hljs-string">'bower_components'</span>,
      <span class="hljs-string">'shared'</span>,
      <span class="hljs-string">'/shared/vendor/modules'</span>,
    ],
  },
};
</code></pre>
<p>If you have JavaScript files that are transformed by Babel, you can <a href="/docs/zh-Hans/23.x/getting-started#using-babel">enable support for Babel</a> by installing the <code>babel-jest</code> plugin. Non-Babel JavaScript transformations can be handled with Jest's <a href="/docs/zh-Hans/23.x/configuration#transform-objectstring-string"><code>transform</code></a> config option.</p>
<h3><a class="anchor" aria-hidden="true" id="处理静态文件"></a><a href="#处理静态文件" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>处理静态文件</h3>
<p>接下来，让我们配置Jest，使其优雅地处理资源文件，如样式表和图像。 通常，这些文件在测试中无足轻重，因为我们可以安全地mock他们。 然而， 如果你使用CSS模块，那么最好是给你的类名查找模拟一个代理。</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-attr">"jest"</span>: {
    <span class="hljs-attr">"moduleNameMapper"</span>: {
      <span class="hljs-attr">"\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/fileMock.js"</span>,
      <span class="hljs-attr">"\\.(css|less)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/styleMock.js"</span>
    }
  }
}
</code></pre>
<p>所有mock文件本身:</p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// __mocks__/styleMock.js</span>

<span class="hljs-built_in">module</span>.exports = {};
</code></pre>
<pre><code class="hljs css language-js"><span class="hljs-comment">// __mocks__/fileMock.js</span>

<span class="hljs-built_in">module</span>.exports = <span class="hljs-string">'test-file-stub'</span>;
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="模拟-css-模块"></a><a href="#模拟-css-模块" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模拟 CSS 模块</h3>
<p>你可以使用 <a href="https://github.com/keyanzhang/identity-obj-proxy">ES6 Proxy</a>来模拟一个 <a href="https://github.com/css-modules/css-modules">CSS </a>:</p>
<pre><code class="hljs css language-bash">yarn add --dev identity-obj-proxy
</code></pre>
<p>然后在样式对象上，你的所有className查找都会原样返回 (如 <code>styles.foobar === 'foobar'</code>) 这对React的<a href="/docs/zh-Hans/23.x/snapshot-testing">Snapshot Testing</a>是相当方便的.</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// package.json (for CSS Modules)</span>
{
  <span class="hljs-attr">"jest"</span>: {
    <span class="hljs-attr">"moduleNameMapper"</span>: {
      <span class="hljs-attr">"\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/fileMock.js"</span>,
      <span class="hljs-attr">"\\.(css|less)$"</span>: <span class="hljs-string">"identity-obj-proxy"</span>
    }
  }
}
</code></pre>
<blockquote>
<p>Notice that Proxy is enabled in Node 6 by default. If you are not on Node 6 yet, make sure you invoke Jest using <code>node --harmony_proxies node_modules/.bin/jest</code>.</p>
</blockquote>
<p>If <code>moduleNameMapper</code> cannot fulfill your requirements, you can use Jest's <a href="/docs/zh-Hans/23.x/configuration#transform-objectstring-string"><code>transform</code></a> config option to specify how assets are transformed. For example, a transformer that returns the basename of a file (such that <code>require('logo.jpg');</code> returns <code>'logo'</code>) can be written as:</p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// fileTransformer.js</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-built_in">module</span>.exports = {
  process(src, filename, config, options) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'module.exports = '</span> + <span class="hljs-built_in">JSON</span>.stringify(path.basename(filename)) + <span class="hljs-string">';'</span>;
  },
};
</code></pre>
<pre><code class="hljs css language-json"><span class="hljs-comment">// package.json (for custom transformers and CSS Modules)</span>
{
  <span class="hljs-attr">"jest"</span>: {
    <span class="hljs-attr">"moduleNameMapper"</span>: {
      <span class="hljs-attr">"\\.(css|less)$"</span>: <span class="hljs-string">"identity-obj-proxy"</span>
    },
    <span class="hljs-attr">"transform"</span>: {
      <span class="hljs-attr">"\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/fileTransformer.js"</span>
    }
  }
}
</code></pre>
<p>我们已经告知Jest忽略相关匹配的样式表或者图像文件，相反，导入我们的模拟文件。 你可以通过调整正规表达式来匹配webpack可以处理的文件类型。</p>
<p><em>注：如果你bael-jest和额外的代码预处理器，你必须明确的定义babel-jest为你的Js代码的转换器，并且你需要映射所有<code>.js</code>文件到babel-jest模块。</em></p>
<pre><code class="hljs css language-json">"transform": {
  "^.+\\.js$": "babel-jest",
  "^.+\\.css$": "custom-transformer",
  ...
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="配置jest来搜寻文件"></a><a href="#配置jest来搜寻文件" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>配置Jest来搜寻文件</h3>
<p>现在Jest知道如何处理我们的文件了， 接下来我们需要告诉它如何<em>找到</em>它们。 webpack的<code>modulesDirectories</code>, 和 <code>extensions</code> 选项都是和Jest的<code>moduleDirectories</code> 和 <code>moduleFileExtensions</code>选项类似的.</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-attr">"jest"</span>: {
    <span class="hljs-attr">"moduleFileExtensions"</span>: [<span class="hljs-string">"js"</span>, <span class="hljs-string">"jsx"</span>],
    <span class="hljs-attr">"moduleDirectories"</span>: [<span class="hljs-string">"node_modules"</span>, <span class="hljs-string">"bower_components"</span>, <span class="hljs-string">"shared"</span>],

    <span class="hljs-attr">"moduleNameMapper"</span>: {
      <span class="hljs-attr">"\\.(css|less)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/styleMock.js"</span>,
      <span class="hljs-attr">"\\.(gif|ttf|eot|svg)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/fileMock.js"</span>
    }
  }
}
</code></pre>
<blockquote>
<p>Note: <code>&lt;rootDir&gt;</code> is a special token that gets replaced by Jest with the root of your project. Most of the time this will be the folder where your <code>package.json</code> is located unless you specify a custom <code>rootDir</code> option in your configuration.</p>
</blockquote>
<p>同样 webpack的 <code>resolve.root</code> 选项，如设置的 <code>NODE_PATH</code> env变量，都可以设置或使用 <code>modulePaths</code> 选项。</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-attr">"jest"</span>: {
    <span class="hljs-attr">"modulePaths"</span>: [<span class="hljs-string">"/shared/vendor/modules"</span>],
    <span class="hljs-attr">"moduleFileExtensions"</span>: [<span class="hljs-string">"js"</span>, <span class="hljs-string">"jsx"</span>],
    <span class="hljs-attr">"moduleDirectories"</span>: [<span class="hljs-string">"node_modules"</span>, <span class="hljs-string">"bower_components"</span>, <span class="hljs-string">"shared"</span>],
    <span class="hljs-attr">"moduleNameMapper"</span>: {
      <span class="hljs-attr">"\\.(css|less)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/styleMock.js"</span>,
      <span class="hljs-attr">"\\.(gif|ttf|eot|svg)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/fileMock.js"</span>
    }
  }
}
</code></pre>
<p>And finally, we have to handle the webpack <code>alias</code>. For that we can make use of the <code>moduleNameMapper</code> option again.</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-attr">"jest"</span>: {
    <span class="hljs-attr">"modulePaths"</span>: [<span class="hljs-string">"/shared/vendor/modules"</span>],
    <span class="hljs-attr">"moduleFileExtensions"</span>: [<span class="hljs-string">"js"</span>, <span class="hljs-string">"jsx"</span>],
    <span class="hljs-attr">"moduleDirectories"</span>: [<span class="hljs-string">"node_modules"</span>, <span class="hljs-string">"bower_components"</span>, <span class="hljs-string">"shared"</span>],

    <span class="hljs-attr">"moduleNameMapper"</span>: {
      <span class="hljs-attr">"^react(.*)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/vendor/react-master$1"</span>,
      <span class="hljs-attr">"^config$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/configs/app-config.js"</span>,

      <span class="hljs-attr">"\\.(css|less)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/styleMock.js"</span>,
      <span class="hljs-attr">"\\.(gif|ttf|eot|svg)$"</span>: <span class="hljs-string">"&lt;rootDir&gt;/__mocks__/fileMock.js"</span>
    }
  }
}
</code></pre>
<p>配置完成。 webpack 是一个复杂和灵活的工具，所以你可能需要做一些调整，以符合你的特定应用的需要。 幸运的是对于大多数项目来说，使用Jest来处理webpack配置，应该会更灵活。</p>
<blockquote>
<p>注︰ 对于更复杂的 webpack 配置，你可能需要研究一些项目，例如︰ <a href="https://github.com/istarkov/babel-plugin-webpack-loaders">babel-plugin-webpack-loaders</a>。</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="使用-webpack-2"></a><a href="#使用-webpack-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用 webpack 2</h2>
<p>webpack 2 提供原生支持ES模块。 However, Jest runs in Node, and thus requires ES modules to be transpiled to CommonJS modules. As such, if you are using webpack 2, you most likely will want to configure Babel to transpile ES modules to CommonJS modules only in the <code>test</code> environment.</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// .babelrc</span>
{
  <span class="hljs-attr">"presets"</span>: [[<span class="hljs-string">"env"</span>, {<span class="hljs-attr">"modules"</span>: <span class="hljs-literal">false</span>}]],

  <span class="hljs-attr">"env"</span>: {
    <span class="hljs-attr">"test"</span>: {
      <span class="hljs-attr">"plugins"</span>: [<span class="hljs-string">"transform-es2015-modules-commonjs"</span>]
    }
  }
}
</code></pre>
<blockquote>
<p>Note: Jest caches files to speed up test execution. If you updated .babelrc and Jest is still not working, try running Jest with <code>--no-cache</code>.</p>
</blockquote>
<p>If you use dynamic imports (<code>import('some-file.js').then(module =&gt; ...)</code>), you need to enable the <code>dynamic-import-node</code> plugin.</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// .babelrc</span>
{
  <span class="hljs-attr">"presets"</span>: [[<span class="hljs-string">"env"</span>, {<span class="hljs-attr">"modules"</span>: <span class="hljs-literal">false</span>}]],

  <span class="hljs-attr">"plugins"</span>: [<span class="hljs-string">"syntax-dynamic-import"</span>],

  <span class="hljs-attr">"env"</span>: {
    <span class="hljs-attr">"test"</span>: {
      <span class="hljs-attr">"plugins"</span>: [<span class="hljs-string">"dynamic-import-node"</span>]
    }
  }
}
</code></pre>
<p>For an example of how to use Jest with Webpack with React, Redux, and Node, you can view one <a href="https://github.com/jenniferkaplannyc/jest_react_redux_node_webpack_complex_example">here</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/zh-Hans/23.x/bypassing-module-mocks"><span class="arrow-prev">← </span><span>Bypassing module mocks</span></a><a class="docs-next button" href="/docs/zh-Hans/23.x/puppeteer"><span>Using with puppeteer</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#webpack-示例">Webpack 示例</a><ul class="toc-headings"><li><a href="#处理静态文件">处理静态文件</a></li><li><a href="#模拟-css-模块">模拟 CSS 模块</a></li><li><a href="#配置jest来搜寻文件">配置Jest来搜寻文件</a></li></ul></li><li><a href="#使用-webpack-2">使用 webpack 2</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/zh-Hans/getting-started.html">Getting Started</a><a href="/docs/zh-Hans/snapshot-testing.html">Guides</a><a href="/docs/zh-Hans/api.html">API Reference</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://www.reactiflux.com/">Reactiflux</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/jest on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-Hans","version:23.x"]}
              });
            </script></body></html>