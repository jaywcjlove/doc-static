<!DOCTYPE html><html lang="zh-Hans"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Troubleshooting · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="遇到什么问题了吗？使用本指南来解决 Jest 使用中的常见问题。"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="zh-Hans"/><meta property="og:title" content="Troubleshooting · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jestjs.io/"/><meta property="og:description" content="遇到什么问题了吗？使用本指南来解决 Jest 使用中的常见问题。"/><meta property="og:image" content="https://jestjs.io/img/opengraph.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://jestjs.io/img/jest.png"/><link rel="shortcut icon" href="/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://jestjs.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://jestjs.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-Hans"><img class="logo" src="/img/jest.svg" alt="Jest"/><h2 class="headerTitleWithLogo">Jest</h2></a><a href="/zh-Hans/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/zh-Hans/next/getting-started" target="_self">文档</a></li><li class="siteNavGroupActive"><a href="/docs/zh-Hans/next/api" target="_self">API</a></li><li class=""><a href="/zh-Hans/help" target="_self">帮助</a></li><li class=""><a href="/blog/" target="_self">博客</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>简体中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/next/troubleshooting">English</a></li><li><a href="/docs/ja/next/troubleshooting">日本語</a></li><li><a href="/docs/es-ES/next/troubleshooting">Español</a></li><li><a href="/docs/pt-BR/next/troubleshooting">Português (Brasil)</a></li><li><a href="/docs/ro/next/troubleshooting">Română</a></li><li><a href="/docs/ru/next/troubleshooting">Русский</a></li><li><a href="/docs/uk/next/troubleshooting">Українська</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/using-matchers">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/asynchronous">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/setup-teardown">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/mock-functions">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/jest-platform">Jest 平台工具</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/jest-community">Jest Community</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/more-resources">More Resources</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/snapshot-testing">快照测试</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/tutorial-async">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/timer-mocks">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/manual-mocks">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/es6-class-mocks">ES6 Class Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/bypassing-module-mocks">Bypassing module mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/webpack">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/puppeteer">Using with puppeteer</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/mongodb">Using with MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/dynamodb">Using with DynamoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/tutorial-jquery">DOM Manipulation</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/watch-plugins">Watch Plugins</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/migration-guide">Migrating to Jest</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/zh-Hans/next/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/architecture">Architecture</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">框架指南</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/tutorial-react">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/tutorial-react-native">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/testing-frameworks">Testing Web Frameworks</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/api">Globals</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/expect">Expect</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/mock-function-api">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/jest-object">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/configuration">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-Hans/next/cli">Jest CLI Options</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/jest/edit/master/docs/Troubleshooting.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Troubleshooting</h1></header><article><div><span><p>遇到什么问题了吗？使用本指南来解决 Jest 使用中的常见问题。</p>
<h2><a class="anchor" aria-hidden="true" id="找不到测试失败的原因"></a><a href="#找不到测试失败的原因" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>找不到测试失败的原因</h2>
<p>Try using the debugging support built into Node. Note: This will only work in Node.js 8+.</p>
<p>在你的单元测试中添加一条 <code>debugger;</code>语句，然后在项目目录中执行：</p>
<pre><code class="hljs css language-bash">node --inspect-brk node_modules/.bin/jest --runInBand [any other arguments here]
or on Windows
node --inspect-brk ./node_modules/jest/bin/jest.js --runInBand [any other arguments here]
</code></pre>
<p>This will run Jest in a Node process that an external debugger can connect to. Note that the process will pause until the debugger has connected to it.</p>
<p>To debug in Google Chrome (or any Chromium-based browser), open your browser and go to <code>chrome://inspect</code> and click on &quot;Open Dedicated DevTools for Node&quot;, which will give you a list of available node instances you can connect to. Click on the address displayed in the terminal (usually something like <code>localhost:9229</code>) after running the above command, and you will be able to debug Jest using Chrome's DevTools.</p>
<p>The Chrome Developer Tools will be displayed, and a breakpoint will be set at the first line of the Jest CLI script (this is done to give you time to open the developer tools and to prevent Jest from executing before you have time to do so). 点击开发者工具中右上方调试菜单栏中的“开始调试” 按钮，让代码继续执行。 当 Jest 执行到添加了<code>debugger;</code> 语句的单元测试时，执行就会暂停，此时，你可以检查当前的值域和调用栈。</p>
<blockquote>
<p>注︰CLI 中 <code>--runInBand</code> 选项能够确保 Jest 执行在同一个进程中，而非为在多个子进程中分别执行。 通常情况下，Jest 并行化测试会跨进程执行，但是很难同时调试多个进程。</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="debugging-in-vs-code"></a><a href="#debugging-in-vs-code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Debugging in VS Code</h2>
<p>There are multiple ways to debug Jest tests with <a href="https://code.visualstudio.com">Visual Studio Code's</a> built in <a href="https://code.visualstudio.com/docs/nodejs/nodejs-debugging">debugger</a>.</p>
<p>To attach the built-in debugger, run your tests as aforementioned:</p>
<pre><code class="hljs css language-bash">node --inspect-brk node_modules/.bin/jest --runInBand [any other arguments here]
or on Windows
node --inspect-brk ./node_modules/jest/bin/jest.js --runInBand [any other arguments here]
</code></pre>
<p>Then attach VS Code's debugger using the following <code>launch.json</code> config:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"0.2.0"</span>,
  <span class="hljs-attr">"configurations"</span>: [
    {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-attr">"request"</span>: <span class="hljs-string">"attach"</span>,
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Attach"</span>,
      <span class="hljs-attr">"port"</span>: <span class="hljs-number">9229</span>
    }
  ]
}
</code></pre>
<p>To automatically launch and attach to a process running your tests, use the following configuration:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"0.2.0"</span>,
  <span class="hljs-attr">"configurations"</span>: [
    {
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Debug Jest Tests"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-attr">"request"</span>: <span class="hljs-string">"launch"</span>,
      <span class="hljs-attr">"runtimeArgs"</span>: [
        <span class="hljs-string">"--inspect-brk"</span>,
        <span class="hljs-string">"${workspaceRoot}/node_modules/.bin/jest"</span>,
        <span class="hljs-string">"--runInBand"</span>
      ],
      <span class="hljs-attr">"console"</span>: <span class="hljs-string">"integratedTerminal"</span>,
      <span class="hljs-attr">"internalConsoleOptions"</span>: <span class="hljs-string">"neverOpen"</span>,
      <span class="hljs-attr">"port"</span>: <span class="hljs-number">9229</span>
    }
  ]
}
</code></pre>
<p>or the following for Windows:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"0.2.0"</span>,
  <span class="hljs-attr">"configurations"</span>: [
    {
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Debug Jest Tests"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-attr">"request"</span>: <span class="hljs-string">"launch"</span>,
      <span class="hljs-attr">"runtimeArgs"</span>: [
        <span class="hljs-string">"--inspect-brk"</span>,
        <span class="hljs-string">"${workspaceRoot}/node_modules/jest/bin/jest.js"</span>,
        <span class="hljs-string">"--runInBand"</span>
      ],
      <span class="hljs-attr">"console"</span>: <span class="hljs-string">"integratedTerminal"</span>,
      <span class="hljs-attr">"internalConsoleOptions"</span>: <span class="hljs-string">"neverOpen"</span>,
      <span class="hljs-attr">"port"</span>: <span class="hljs-number">9229</span>
    }
  ]
}
</code></pre>
<p>If you are using Facebook's <a href="https://github.com/facebookincubator/create-react-app"><code>create-react-app</code></a>, you can debug your Jest tests with the following configuration:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"0.2.0"</span>,
  <span class="hljs-attr">"configurations"</span>: [
    {
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Debug CRA Tests"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-attr">"request"</span>: <span class="hljs-string">"launch"</span>,
      <span class="hljs-attr">"runtimeExecutable"</span>: <span class="hljs-string">"${workspaceRoot}/node_modules/.bin/react-scripts"</span>,
      <span class="hljs-attr">"args"</span>: [<span class="hljs-string">"test"</span>, <span class="hljs-string">"--runInBand"</span>, <span class="hljs-string">"--no-cache"</span>, <span class="hljs-string">"--env=jsdom"</span>],
      <span class="hljs-attr">"cwd"</span>: <span class="hljs-string">"${workspaceRoot}"</span>,
      <span class="hljs-attr">"protocol"</span>: <span class="hljs-string">"inspector"</span>,
      <span class="hljs-attr">"console"</span>: <span class="hljs-string">"integratedTerminal"</span>,
      <span class="hljs-attr">"internalConsoleOptions"</span>: <span class="hljs-string">"neverOpen"</span>
    }
  ]
}
</code></pre>
<p>更多关于 Node 调试的信息，可以查看<a href="https://nodejs.org/api/debugger.html">这里</a></p>
<h2><a class="anchor" aria-hidden="true" id="debugging-in-webstorm"></a><a href="#debugging-in-webstorm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Debugging in WebStorm</h2>
<p>The easiest way to debug Jest tests in <a href="https://www.jetbrains.com/webstorm/">WebStorm</a> is using <code>Jest run/debug configuration</code>. It will launch tests and automatically attach debugger.</p>
<p>In the WebStorm menu <code>Run</code> select <code>Edit Configurations...</code>. Then click <code>+</code> and select <code>Jest</code>. Optionally specify the Jest configuration file, additional options, and environment variables. Save the configuration, put the breakpoints in the code, then click the green debug icon to start debugging.</p>
<p>If you are using Facebook's <a href="https://github.com/facebookincubator/create-react-app"><code>create-react-app</code></a>, in the Jest run/debug configuration specify the path to the <code>react-scripts</code> package in the Jest package field and add <code>--env=jsdom</code> to the Jest options field.</p>
<h2><a class="anchor" aria-hidden="true" id="缓存问题"></a><a href="#缓存问题" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>缓存问题</h2>
<p>The transform script was changed or Babel was updated and the changes aren't being recognized by Jest?</p>
<p>尝试使用 <a href="/docs/zh-Hans/next/cli#--cache"><code>--no-cache</code></a> 选项。 Jest 会缓存转换的模块文件来加速测试的执行。 If you are using your own custom transformer, consider adding a <code>getCacheKey</code> function to it: <a href="https://github.com/facebook/relay/blob/58cf36c73769690f0bbf90562707eadb062b029d/scripts/jest/preprocessor.js#L56-L61">getCacheKey in Relay</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="未返回的-promises"></a><a href="#未返回的-promises" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>未返回的 Promises</h2>
<p>如果一个 Promise 并未返回任何东西（no resolve）你会看到类似于下边的报错：</p>
<pre><code class="hljs css language-bash">- Error: Timeout - Async callback was not invoked within timeout specified by jasmine.DEFAULT_TIMEOUT_INTERVAL.`
</code></pre>
<p>通常这是由冲突的Promise 实现引发的。 Consider replacing the global promise implementation with your own, for example <code>global.Promise = jest.requireActual('promise');</code> and/or consolidate the used Promise libraries to a single one.</p>
<p>If your test is long running, you may want to consider to increase the timeout by calling <code>jest.setTimeout</code></p>
<pre><code class="hljs css language-js">jest.setTimeout(<span class="hljs-number">10000</span>); <span class="hljs-comment">// 10 second timeout</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="看门狗问题"></a><a href="#看门狗问题" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>看门狗问题</h2>
<p>Try running Jest with <a href="/docs/zh-Hans/next/cli#--watchman"><code>--no-watchman</code></a> or set the <code>watchman</code> configuration option to <code>false</code>.</p>
<p>更多详情，查看 <a href="https://facebook.github.io/watchman/docs/troubleshooting.html">看门狗疑难解答</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="docker-和或-持续集成（ci，continuous-integration）服务器中执行-jest-测试极慢。"></a><a href="#docker-和或-持续集成（ci，continuous-integration）服务器中执行-jest-测试极慢。" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Docker 和/或 持续集成（CI，Continuous Integration）服务器中执行 Jest 测试极慢。</h2>
<p>While Jest is most of the time extremely fast on modern multi-core computers with fast SSDs, it may be slow on certain setups as our users <a href="https://github.com/facebook/jest/issues/1395">have</a> <a href="https://github.com/facebook/jest/issues/1524#issuecomment-260246008">discovered</a>.</p>
<p>Based on the <a href="https://github.com/facebook/jest/issues/1524#issuecomment-262366820">findings</a>, one way to mitigate this issue and improve the speed by up to 50% is to run tests sequentially.</p>
<p>达成上述目的，可以使用<a href="/docs/zh-Hans/next/cli#--runinband"><code>--runInBand</code></a>选项：</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Using Jest CLI</span>
jest --runInBand

<span class="hljs-comment"># Using yarn test (e.g. with create-react-app)</span>
yarn <span class="hljs-built_in">test</span> --runInBand
</code></pre>
<p>Another alternative to expediting test execution time on Continuous Integration Servers such as Travis-CI is to set the max worker pool to ~<em>4</em>. Specifically on Travis-CI, this can reduce test execution time in half. Note: The Travis CI <em>free</em> plan available for open source projects only includes 2 CPU cores.</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># Using Jest CLI</span>
jest --maxWorkers=4

<span class="hljs-comment"># Using yarn test (e.g. with create-react-app)</span>
yarn <span class="hljs-built_in">test</span> --maxWorkers=4
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="兼容问题"></a><a href="#兼容问题" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>兼容问题</h2>
<p>Jest takes advantage of new features added to Node 6. We recommend that you upgrade to the latest stable release of Node. The minimum supported version is <code>v6.0.0</code>. Versions <code>0.x.x</code> and <code>4.x.x</code> are not supported because the <code>jsdom</code> version used in Jest doesn't support Node 4. However, if you need to run Jest on Node 4, you can use the <code>testEnvironment</code> config to use a <a href="https://jestjs.io/docs/en/configuration.html#testenvironment-string">custom environment</a> that supports Node 4, such as <a href="https://yarnpkg.com/en/package/jest-environment-node"><code>jest-environment-node</code></a>.</p>
<h2><a class="anchor" aria-hidden="true" id="coveragepathignorepatterns-seems-to-not-have-any-effect"></a><a href="#coveragepathignorepatterns-seems-to-not-have-any-effect" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>coveragePathIgnorePatterns</code> seems to not have any effect.</h2>
<p>Make sure you are not using the <code>babel-plugin-istanbul</code> plugin. Jest wraps Istanbul, and therefore also tells Istanbul what files to instrument with coverage collection. When using <code>babel-plugin-istanbul</code>, every file that is processed by Babel will have coverage collection code, hence it is not being ignored by <code>coveragePathIgnorePatterns</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="defining-tests"></a><a href="#defining-tests" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Defining Tests</h2>
<p>Tests must be defined synchronously for Jest to be able to collect your tests.</p>
<p>As an example to show why this is the case, imagine we wrote a test like so:</p>
<pre><code class="hljs css language-js"><span class="hljs-comment">// Don't do this it will not work</span>
setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  it(<span class="hljs-string">'passes'</span>, () =&gt; expect(<span class="hljs-number">1</span>).toBe(<span class="hljs-number">1</span>));
}, <span class="hljs-number">0</span>);
</code></pre>
<p>When Jest runs your test to collect the <code>test</code>s it will not find any because we have set the definition to happen asynchronously on the next tick of the event loop.</p>
<p><em>Note:</em> This means when you are using <code>test.each</code> you cannot set the table asynchronously within a <code>beforeEach</code> / <code>beforeAll</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="尚未解决问题？"></a><a href="#尚未解决问题？" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>尚未解决问题？</h2>
<p>点 <a href="/help.html">这里</a> 查看帮助</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/zh-Hans/next/migration-guide"><span class="arrow-prev">← </span><span>Migrating to Jest</span></a><a class="docs-next button" href="/docs/zh-Hans/next/architecture"><span>Architecture</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#找不到测试失败的原因">找不到测试失败的原因</a></li><li><a href="#debugging-in-vs-code">Debugging in VS Code</a></li><li><a href="#debugging-in-webstorm">Debugging in WebStorm</a></li><li><a href="#缓存问题">缓存问题</a></li><li><a href="#未返回的-promises">未返回的 Promises</a></li><li><a href="#看门狗问题">看门狗问题</a></li><li><a href="#docker-和或-持续集成（ci，continuous-integration）服务器中执行-jest-测试极慢。">Docker 和/或 持续集成（CI，Continuous Integration）服务器中执行 Jest 测试极慢。</a></li><li><a href="#兼容问题">兼容问题</a></li><li><a href="#coveragepathignorepatterns-seems-to-not-have-any-effect"><code>coveragePathIgnorePatterns</code> seems to not have any effect.</a></li><li><a href="#defining-tests">Defining Tests</a></li><li><a href="#尚未解决问题？">尚未解决问题？</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/zh-Hans/getting-started.html">Getting Started</a><a href="/docs/zh-Hans/snapshot-testing.html">Guides</a><a href="/docs/zh-Hans/api.html">API Reference</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discord.gg/MWRhKCj">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/jest on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-Hans","version:next"]}
              });
            </script></body></html>