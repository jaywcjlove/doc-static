<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="JavaScript, Linter, Linting, Pluggable, Configurable, Code Quality"><meta name="description" content="A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease."><meta name="theme-color" content="#463fd4"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="ESLint - Pluggable JavaScript linter"><meta property="og:title" content="callback-return - Rules"><meta property="og:url" content="/docs/6.0.0/rules/callback-return"><meta property="og:image" content="https://eslint.org/assets/img/favicon.512x512.png"><meta name="twitter:site" content="@geteslint"><meta name="twitter:title" content="callback-return - Rules"><meta name="twitter:description" content="A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease."><meta name="twitter:url" content="/docs/6.0.0/rules/callback-return"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://eslint.org/assets/img/favicon.512x512.png"><title>callback-return - Rules - ESLint - Pluggable JavaScript linter</title><link rel="preconnect" href="https://www.google-analytics.com"><link rel="canonical" href="/docs/6.0.0/rules/callback-return"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600"><link rel="stylesheet" href="/assets/styles/main.css"><link rel="manifest" href="/manifest.json"><link rel="icon" href="/assets/img/favicon.512x512.png"><link rel="alternate" type="application/rss+xml" title="ESLint - Pluggable JavaScript linter" href="/feed.xml"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"></head><body class="banner-displayed"><input type="checkbox" id="eslint-toggle-search" class="eslint-toggle-search-checkbox"><header class="navbar navbar-default navbar-demo navbar-fixed-top eslint-nav" id="top" role="banner"><div class="eslint-banner" style="color: #ffffff; background-color: #150b29"><p><a href="https://code2040-2020.funraise.org/" style="color: #a486df">Donate to Code2040</a></p></div><div class="container"><a href="/" class="navbar-brand"><img alt="ESLint" src="/assets/img/logo.svg" itemprop="image">ESLint</a><div class="eslint-navbar-toggles"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#eslint-navbar" aria-controls="eslint-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open"><span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span></label></div><nav id="eslint-navbar" class="collapse navbar-collapse eslint-navbar"><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a href="/docs/user-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">User guide<span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li><a href="/docs/user-guide/getting-started">Getting Started</a></li><li><a href="/docs/user-guide/configuring">Configuring ESLint</a></li><li><a href="/docs/user-guide/command-line-interface">Command Line Interface</a></li><li><a href="/docs/rules">Rules</a></li><li><a href="/docs/user-guide/formatters">Formatters</a></li><li><a href="/docs/user-guide/integrations">Integrations</a></li><li class="divider"></li><li><a href="/docs/user-guide/migrating-to-7.0.0">Migrating to v7.0.0</a></li><li><a href="/docs/user-guide/migrating-to-6.0.0">Migrating to v6.0.0</a></li><li><a href="/docs/user-guide/migrating-to-5.0.0">Migrating to v5.0.0</a></li><li><a href="/docs/user-guide/migrating-to-4.0.0">Migrating to v4.0.0</a></li><li><a href="/docs/user-guide/migrating-to-3.0.0">Migrating to v3.0.0</a></li><li><a href="/docs/user-guide/migrating-to-2.0.0">Migrating to v2.0.0</a></li><li><a href="/docs/user-guide/migrating-to-1.0.0">Migrating to v1.0.0</a></li><li><a href="/docs/user-guide/migrating-from-jscs">Migrating from JSCS</a></li></ul></li><li class="dropdown"><a href="/docs/developer-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Developer guide<span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li><a href="/docs/developer-guide/architecture">Architecture</a></li><li><a href="/docs/developer-guide/contributing">Contributing</a></li><li><a href="/docs/developer-guide/source-code">Get the Source Code</a></li><li><a href="/docs/developer-guide/development-environment">Set up a Development Environment</a></li><li><a href="/docs/developer-guide/unit-tests">Run the Unit Tests</a></li><li><a href="/docs/developer-guide/working-with-rules">Working with Rules</a></li><li><a href="/docs/developer-guide/working-with-plugins">Working with Plugins</a></li><li><a href="/docs/developer-guide/working-with-custom-formatters">Working with Custom Formatters</a></li><li><a href="/docs/developer-guide/working-with-custom-parsers">Working with Custom Parsers</a></li><li><a href="/docs/developer-guide/shareable-configs">Shareable Configs</a></li><li><a href="/docs/developer-guide/nodejs-api">Node.js API</a></li><li><a href="/docs/maintainer-guide">Maintainer guide</a></li></ul></li><li><a href="/blog">Blog</a></li><li><a href="/demo">Demo</a></li><li class="dropdown"><a href="/docs/about" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">About<span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li><a href="/users">Who's Using ESLint?</a></li><li><a href="/team">About the Team</a></li><li><a href="/docs/about">About ESLint</a></li></ul></li></ul><label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open"><span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span></label><div class="navbar-form navbar-right eslint-search" role="search"><div class="input-group"><label class="sr-only" aria-label="Search" for="eslint-search-input">Search</label><div class="eslint-search-input-wrapper"><input type="text" class="form-control" id="eslint-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search the docs..."> <label for="eslint-toggle-search" class="eslint-toggle-search-close"><span class="sr-only">Close search</span> <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span></label></div></div></div></nav></div></header><main class="doc"><article class="container"><h1 id="enforce-return-after-callback-callback-return-8">Enforce Return After Callback (callback-return)</h1><p>The callback pattern is at the heart of most I/O and event-driven programming in JavaScript.</p><pre class="hljs highlight-js"><code><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doSomething</span>(<span class="hljs-params">err, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-keyword">return</span> callback(err);
    }
    callback();
}
</code></pre><p>To prevent calling the callback multiple times it is important to <code>return</code> anytime the callback is triggered outside of the main function body. Neglecting this technique often leads to issues where you do something more than once. For example, in the case of an HTTP request, you may try to send HTTP headers more than once leading Node.js to <code>throw</code> a <code>Can't render headers after they are sent to the client.</code> error.</p><h2 id="rule-details-2129">Rule Details</h2><p>This rule is aimed at ensuring that callbacks used outside of the main function block are always part-of or immediately preceding a <code>return</code> statement. This rule decides what is a callback based on the name of the function being called.</p><h2 id="options-987">Options</h2><p>The rule takes a single option - an array of possible callback names - which may include object methods. The default callback names are <code>callback</code>, <code>cb</code>, <code>next</code>.</p><h3 id="default-callback-names-5">Default callback names</h3><p class="incorrect icon">Examples of <strong>incorrect</strong> code for this rule with the default <code>[&quot;callback&quot;, &quot;cb&quot;, &quot;next&quot;]</code> option:</p><pre class="hljs highlight-js"><code><span class="hljs-comment">/*eslint callback-return: &quot;error&quot;*/</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">err, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        callback(err);
    }
    callback();
}
</code></pre><p class="correct icon">Examples of <strong>correct</strong> code for this rule with the default <code>[&quot;callback&quot;, &quot;cb&quot;, &quot;next&quot;]</code> option:</p><pre class="hljs highlight-js"><code><span class="hljs-comment">/*eslint callback-return: &quot;error&quot;*/</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">err, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-keyword">return</span> callback(err);
    }
    callback();
}
</code></pre><h3 id="supplied-callback-names-5">Supplied callback names</h3><p class="incorrect icon">Examples of <strong>incorrect</strong> code for this rule with the option <code>[&quot;done&quot;, &quot;send.error&quot;, &quot;send.success&quot;]</code>:</p><pre class="hljs highlight-js"><code><span class="hljs-comment">/*eslint callback-return: [&quot;error&quot;, [&quot;done&quot;, &quot;send.error&quot;, &quot;send.success&quot;]]*/</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">err, done</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        done(err);
    }
    done();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bar</span>(<span class="hljs-params">err, send</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        send.error(err);
    }
    send.success();
}
</code></pre><p class="correct icon">Examples of <strong>correct</strong> code for this rule with the option <code>[&quot;done&quot;, &quot;send.error&quot;, &quot;send.success&quot;]</code>:</p><pre class="hljs highlight-js"><code><span class="hljs-comment">/*eslint callback-return: [&quot;error&quot;, [&quot;done&quot;, &quot;send.error&quot;, &quot;send.success&quot;]]*/</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">err, done</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-keyword">return</span> done(err);
    }
    done();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bar</span>(<span class="hljs-params">err, send</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-keyword">return</span> send.error(err);
    }
    send.success();
}
</code></pre><h2 id="known-limitations-55">Known Limitations</h2><p>Because it is difficult to understand the meaning of a program through static analysis, this rule has limitations:</p><ul><li><em>false negatives</em> when this rule reports correct code, but the program calls the callback more than one time (which is incorrect behavior)</li><li><em>false positives</em> when this rule reports incorrect code, but the program calls the callback only one time (which is correct behavior)</li></ul><h3 id="passing-the-callback-by-reference-8">Passing the callback by reference</h3><p>The static analysis of this rule does not detect that the program calls the callback if it is an argument of a function (for example, <code>setTimeout</code>).</p><p>Example of a <em>false negative</em> when this rule reports correct code:</p><pre class="hljs highlight-js"><code><span class="hljs-comment">/*eslint callback-return: &quot;error&quot;*/</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">err, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-built_in">setTimeout</span>(callback, <span class="hljs-number">0</span>); <span class="hljs-comment">// this is bad, but WILL NOT warn</span>
    }
    callback();
}
</code></pre><h3 id="triggering-the-callback-within-a-nested-function-8">Triggering the callback within a nested function</h3><p>The static analysis of this rule does not detect that the program calls the callback from within a nested function or an immediately-invoked function expression (IIFE).</p><p>Example of a <em>false negative</em> when this rule reports correct code:</p><pre class="hljs highlight-js"><code><span class="hljs-comment">/*eslint callback-return: &quot;error&quot;*/</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">err, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> callback(); <span class="hljs-comment">// this is bad, but WILL NOT warn</span>
        });
    }
    callback();
}
</code></pre><h3 id="ifelse-statements-8">If/else statements</h3><p>The static analysis of this rule does not detect that the program calls the callback only one time in each branch of an <code>if</code> statement.</p><p>Example of a <em>false positive</em> when this rule reports incorrect code:</p><pre class="hljs highlight-js"><code><span class="hljs-comment">/*eslint callback-return: &quot;error&quot;*/</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foo</span>(<span class="hljs-params">err, callback</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        callback(err); <span class="hljs-comment">// this is fine, but WILL warn</span>
    } <span class="hljs-keyword">else</span> {
        callback();    <span class="hljs-comment">// this is fine, but WILL warn</span>
    }
}
</code></pre><h2 id="when-not-to-use-it-1315">When Not To Use It</h2><p>There are some cases where you might want to call a callback function more than once. In those cases this rule may lead to incorrect behavior. In those cases you may want to reserve a special name for those callbacks and not include that in the list of callbacks that trigger warnings.</p><h2 id="further-reading-570">Further Reading</h2><ul><li><a href="https://github.com/maxogden/art-of-node#callbacks">The Art Of Node: Callbacks</a></li><li><a href="https://docs.nodejitsu.com/articles/errors/what-are-the-error-conventions/">Nodejitsu: What are the error conventions?</a></li></ul><h2 id="related-rules-708">Related Rules</h2><ul><li><a href="handle-callback-err">handle-callback-err</a></li></ul><h2 id="version-2133">Version</h2><p>This rule was introduced in ESLint 1.0.0-rc-1.</p><h2 id="resources-2133">Resources</h2><ul><li><a href="https://github.com/eslint/eslint/tree/master/lib/rules/callback-return.js">Rule source</a></li><li><a href="https://github.com/eslint/eslint/tree/master/docs/rules/callback-return.md">Documentation source</a></li></ul></article></main><hr><div class="container"><footer><ul class="list-inline"><li><a href="https://github.com/eslint/eslint/edit/master/docs/rules/callback-return.md">Edit this page</a></li><li><a href="https://groups.google.com/group/eslint">Mailing List</a></li><li><a href="https://github.com/eslint/eslint">GitHub</a></li><li><a href="https://twitter.com/geteslint">Twitter</a></li><li><a href="/chat">Chat Room</a></li><li>Copyright OpenJS Foundation and other contributors, <a href="https://openjsf.org/">https://openjsf.org/</a></li></ul></footer></div><script src="/assets/js/main.js"></script></body></html>