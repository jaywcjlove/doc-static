<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="JavaScript, Linter, Linting, Pluggable, Configurable, Code Quality"><meta name="description" content="A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease."><meta name="theme-color" content="#463fd4"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="ESLint - Pluggable JavaScript linter"><meta property="og:title" content="Working with Custom Parsers"><meta property="og:url" content="/docs/6.0.0/developer-guide/working-with-custom-parsers"><meta property="og:image" content="https://eslint.org/assets/img/favicon.512x512.png"><meta name="twitter:site" content="@geteslint"><meta name="twitter:title" content="Working with Custom Parsers"><meta name="twitter:description" content="A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease."><meta name="twitter:url" content="/docs/6.0.0/developer-guide/working-with-custom-parsers"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://eslint.org/assets/img/favicon.512x512.png"><title>Working with Custom Parsers - ESLint - Pluggable JavaScript linter</title><link rel="preconnect" href="https://www.google-analytics.com"><link rel="canonical" href="/docs/6.0.0/developer-guide/working-with-custom-parsers"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600"><link rel="stylesheet" href="/assets/styles/main.css"><link rel="manifest" href="/manifest.json"><link rel="icon" href="/assets/img/favicon.512x512.png"><link rel="alternate" type="application/rss+xml" title="ESLint - Pluggable JavaScript linter" href="/feed.xml"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"><script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script></head><body><input type="checkbox" id="eslint-toggle-search" class="eslint-toggle-search-checkbox"><header class="navbar navbar-default navbar-demo navbar-fixed-top eslint-nav" id="top" role="banner"><div class="container"><a href="/" class="navbar-brand"><img alt="ESLint" src="/assets/img/logo.svg" itemprop="image">ESLint</a><div class="eslint-navbar-toggles"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#eslint-navbar" aria-controls="eslint-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open"><span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span></label></div><nav id="eslint-navbar" class="collapse navbar-collapse eslint-navbar"><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a href="/docs/user-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">User guide<span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li><a href="/docs/user-guide/getting-started">Getting Started</a></li><li><a href="/docs/user-guide/configuring">Configuring ESLint</a></li><li><a href="/docs/user-guide/command-line-interface">Command Line Interface</a></li><li><a href="/docs/rules">Rules</a></li><li><a href="/docs/user-guide/formatters">Formatters</a></li><li><a href="/docs/user-guide/integrations">Integrations</a></li><li class="divider"></li><li><a href="/docs/user-guide/migrating-to-7.0.0">Migrating to v7.0.0</a></li><li><a href="/docs/user-guide/migrating-to-6.0.0">Migrating to v6.0.0</a></li><li><a href="/docs/user-guide/migrating-to-5.0.0">Migrating to v5.0.0</a></li><li><a href="/docs/user-guide/migrating-to-4.0.0">Migrating to v4.0.0</a></li><li><a href="/docs/user-guide/migrating-to-3.0.0">Migrating to v3.0.0</a></li><li><a href="/docs/user-guide/migrating-to-2.0.0">Migrating to v2.0.0</a></li><li><a href="/docs/user-guide/migrating-to-1.0.0">Migrating to v1.0.0</a></li><li><a href="/docs/user-guide/migrating-from-jscs">Migrating from JSCS</a></li></ul></li><li class="dropdown"><a href="/docs/developer-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Developer guide<span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li><a href="/docs/developer-guide/architecture">Architecture</a></li><li><a href="/docs/developer-guide/contributing">Contributing</a></li><li><a href="/docs/developer-guide/source-code">Get the Source Code</a></li><li><a href="/docs/developer-guide/development-environment">Set up a Development Environment</a></li><li><a href="/docs/developer-guide/unit-tests">Run the Unit Tests</a></li><li><a href="/docs/developer-guide/working-with-rules">Working with Rules</a></li><li><a href="/docs/developer-guide/working-with-plugins">Working with Plugins</a></li><li><a href="/docs/developer-guide/working-with-custom-formatters">Working with Custom Formatters</a></li><li><a href="/docs/developer-guide/working-with-custom-parsers">Working with Custom Parsers</a></li><li><a href="/docs/developer-guide/shareable-configs">Shareable Configs</a></li><li><a href="/docs/developer-guide/nodejs-api">Node.js API</a></li><li><a href="/docs/maintainer-guide">Maintainer guide</a></li></ul></li><li><a href="/blog">Blog</a></li><li><a href="/demo">Demo</a></li><li class="dropdown"><a href="/docs/about" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">About<span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li><a href="/users">Who's Using ESLint?</a></li><li><a href="/team">About the Team</a></li><li><a href="/docs/about">About ESLint</a></li></ul></li></ul><label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open"><span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span></label><div class="navbar-form navbar-right eslint-search" role="search"><div class="input-group"><label class="sr-only" aria-label="Search" for="eslint-search-input">Search</label><div class="eslint-search-input-wrapper"><input type="text" class="form-control" id="eslint-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search the docs..."> <label for="eslint-toggle-search" class="eslint-toggle-search-close"><span class="sr-only">Close search</span> <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span></label></div></div></div></nav></div></header><main class="doc"><article class="container"><div class="eslint-ad-float hidden-xs hidden-sm"><div class="bordered" data-ea-publisher="eslint-org" data-ea-type="image"><div class="eslint-ad eslint-image-ad"><div class="eslint-ad-content"><a href="https://opencollective.com/eslint" rel="nofollow" target="_blank"><img src="/assets/img/logo.svg"></a><div class="eslint-ad-text"><a href="http://opencollective.com/eslint" rel="nofollow" target="_blank"><strong>Sponsor ESLint.</strong> ESLint depends on donations for ongoing maintenance and development.</a></div></div></div></div></div><h1 id="working-with-custom-parsers">Working with Custom Parsers</h1><p>If you want to use your own parser and provide additional capabilities for your rules, you can specify your own custom parser. If a <code>parseForESLint</code> method is exposed on the parser, this method will be used to parse the code. Otherwise, the <code>parse</code> method will be used. Both methods should take in the source code as the first argument, and an optional configuration object as the second argument (provided as <code>parserOptions</code> in a config file). The <code>parse</code> method should simply return the AST. The <code>parseForESLint</code> method should return an object that contains the required property <code>ast</code> and optional properties <code>services</code>, <code>scopeManager</code>, and <code>visitorKeys</code>.</p><ul><li><code>ast</code> should contain the AST.</li><li><code>services</code> can contain any parser-dependent services (such as type checkers for nodes). The value of the <code>services</code> property is available to rules as <code>context.parserServices</code>. Default is an empty object.</li><li><code>scopeManager</code> can be a <a href="./scope-manager-interface">ScopeManager</a> object. Custom parsers can use customized scope analysis for experimental/enhancement syntaxes. Default is the <code>ScopeManager</code> object which is created by <a href="https://github.com/eslint/eslint-scope">eslint-scope</a>.<ul><li>Support for <code>scopeManager</code> was added in ESLint v4.14.0. ESLint versions which support <code>scopeManager</code> will provide an <code>eslintScopeManager: true</code> property in <code>parserOptions</code>, which can be used for feature detection.</li></ul></li><li><code>visitorKeys</code> can be an object to customize AST traversal. The keys of the object are the type of AST nodes. Each value is an array of the property names which should be traversed. Default is <a href="https://github.com/eslint/eslint-visitor-keys#evkkeys">KEYS of <code>eslint-visitor-keys</code></a>.<ul><li>Support for <code>visitorKeys</code> was added in ESLint v4.14.0. ESLint versions which support <code>visitorKeys</code> will provide an <code>eslintVisitorKeys: true</code> property in <code>parserOptions</code>, which can be used for feature detection.</li></ul></li></ul><p>You can find an ESLint parser project <a href="https://github.com/typescript-eslint/typescript-eslint">here</a>.</p><pre class="hljs highlight-json"><code>{
    <span class="hljs-attr">&quot;parser&quot;</span>: <span class="hljs-string">&quot;./path/to/awesome-custom-parser.js&quot;</span>
}
</code></pre><pre class="hljs highlight-javascript"><code><span class="hljs-keyword">var</span> espree = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;espree&quot;</span>);
<span class="hljs-comment">// awesome-custom-parser.js</span>
<span class="hljs-built_in">exports</span>.parseForESLint = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code, options</span>) </span>{
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">ast</span>: espree.parse(code, options),
        <span class="hljs-attr">services</span>: {
            <span class="hljs-attr">foo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;foo&quot;</span>);
            }
        },
        <span class="hljs-attr">scopeManager</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">visitorKeys</span>: <span class="hljs-literal">null</span>
    };
};

</code></pre><h2 id="the-ast-specification">The AST specification</h2><p>The AST that custom parsers should create is based on <a href="https://github.com/estree/estree">ESTree</a>. The AST requires some additional properties about detail information of the source code.</p><h3 id="all-nodes">All nodes:</h3><p>All nodes must have <code>range</code> property.</p><ul><li><code>range</code> (<code>number[]</code>) is an array of two numbers. Both numbers are a 0-based index which is the position in the array of source code characters. The first is the start position of the node, the second is the end position of the node. <code>code.slice(node.range[0], node.range[1])</code> must be the text of the node. This range does not include spaces/parentheses which are around the node.</li><li><code>loc</code> (<code>SourceLocation</code>) must not be <code>null</code>. <a href="https://github.com/estree/estree/blob/25834f7247d44d3156030f8e8a2d07644d771fdb/es5.md#node-objects">The <code>loc</code> property is defined as nullable by ESTree</a>, but ESLint requires this property. On the other hand, <code>SourceLocation#source</code> property can be <code>undefined</code>. ESLint does not use the <code>SourceLocation#source</code> property.</li></ul><p>The <code>parent</code> property of all nodes must be rewriteable. ESLint sets each node's <code>parent</code> property to its parent node while traversing, before any rules have access to the AST.</p><h3 id="the-program-node">The <code>Program</code> node:</h3><p>The <code>Program</code> node must have <code>tokens</code> and <code>comments</code> properties. Both properties are an array of the below Token interface.</p><pre class="hljs highlight-ts"><code><span class="hljs-keyword">interface</span> Token {
    <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;
    loc: SourceLocation;
    range: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>]; <span class="hljs-comment">// See &quot;All nodes:&quot; section for details of `range` property.</span>
    value: <span class="hljs-built_in">string</span>;
}
</code></pre><ul><li><code>tokens</code> (<code>Token[]</code>) is the array of tokens which affect the behavior of programs. Arbitrary spaces can exist between tokens, so rules check the <code>Token#range</code> to detect spaces between tokens. This must be sorted by <code>Token#range[0]</code>.</li><li><code>comments</code> (<code>Token[]</code>) is the array of comment tokens. This must be sorted by <code>Token#range[0]</code>.</li></ul><p>The range indexes of all tokens and comments must not overlap with the range of other tokens and comments.</p><h3 id="the-literal-node">The <code>Literal</code> node:</h3><p>The <code>Literal</code> node must have <code>raw</code> property.</p><ul><li><code>raw</code> (<code>string</code>) is the source code of this literal. This is the same as <code>code.slice(node.range[0], node.range[1])</code>.</li></ul></article></main><hr><div class="container"><footer><ul class="list-inline" style="text-align: center;"><li><a href="https://groups.google.com/group/eslint"><i class="fab fa-google fa-2x"></i> <span style="display:block;position:relative">Group</span></a></li><li><a href="https://github.com/eslint/eslint"><i class="fab fa-github fa-2x"></i> <span style="display:block;position:relative">Github</span></a></li><li><a href="https://twitter.com/geteslint"><i class="fab fa-twitter fa-2x"></i> <span style="display:block;position:relative">Twitter</span></a></li><li><a href="/chat"><i class="fab fa-discord fa-2x"></i> <span style="display:block;position:relative">Discord</span></a></li><br><li>Copyright OpenJS Foundation and other contributors, <a href="https://openjsf.org/">www.openjsf.org</a></li><li><a href="https://github.com/eslint/eslint/edit/master/docs/developer-guide/working-with-custom-parsers.md">Edit this page</a></li></ul></footer></div><script src="/assets/js/main.js"></script><script src="https://kit.fontawesome.com/6ebce1c175.js" crossorigin="anonymous"></script></body></html>