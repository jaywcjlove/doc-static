define(["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.setupJSONToggleForConfig = exports.updateConfigDropdownForCompilerOptions = exports.createConfigDropdown = void 0;
    const createConfigDropdown = (sandbox, monaco) => {
        const configContainer = document.getElementById("config-container");
        const container = document.createElement("div");
        container.id = "boolean-options-container";
        configContainer.appendChild(container);
        const compilerOpts = sandbox.getCompilerOptions();
        const boolOptions = Object.keys(compilerOpts).filter(k => typeof compilerOpts[k] === "boolean");
        // we want to make sections of categories
        const categoryMap = {};
        boolOptions.forEach(optID => {
            const summary = optionsSummary.find(sum => optID === sum.id);
            const existingCategory = categoryMap[summary.categoryID];
            if (!existingCategory)
                categoryMap[summary.categoryID] = {};
            categoryMap[summary.categoryID][optID] = summary;
        });
        Object.keys(categoryMap).forEach(categoryID => {
            const categoryDiv = document.createElement("div");
            const header = document.createElement("h4");
            const ol = document.createElement("ol");
            Object.keys(categoryMap[categoryID]).forEach(optID => {
                const optSummary = categoryMap[categoryID][optID];
                header.textContent = optSummary.categoryDisplay;
                const li = document.createElement("li");
                const label = document.createElement("label");
                label.style.position = "relative";
                label.style.width = "100%";
                const svg = `<?xml version="1.0" encoding="UTF-8"?><svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <circle stroke="#0B6F57" cx="10" cy="10" r="9"></circle>
            <path d="M9.99598394,6 C10.2048193,6 10.4243641,5.91700134 10.6546185,5.75100402 C10.8848728,5.58500669 11,5.33601071 11,5.00401606 C11,4.66666667 10.8848728,4.41499331 10.6546185,4.24899598 C10.4243641,4.08299866 10.2048193,4 9.99598394,4 C9.79250335,4 9.57563588,4.08299866 9.34538153,4.24899598 C9.11512718,4.41499331 9,4.66666667 9,5.00401606 C9,5.33601071 9.11512718,5.58500669 9.34538153,5.75100402 C9.57563588,5.91700134 9.79250335,6 9.99598394,6 Z M10.6877323,16 L10.6877323,14.8898836 L10.6877323,8 L9.30483271,8 L9.30483271,9.11011638 L9.30483271,16 L10.6877323,16 Z" fill="#0B6F57" fill-rule="nonzero"></path>
          </g>
      </svg>`;
                label.innerHTML = `<span>${optSummary.id}</span><a href='../tsconfig#${optSummary.id}' class='compiler_info_link' alt='Look up ${optSummary.id} in the TSConfig Reference'>${svg}</a><br/>${optSummary.oneliner}`;
                const input = document.createElement("input");
                input.value = optSummary.id;
                input.type = "checkbox";
                input.name = optSummary.id;
                input.id = "option-" + optSummary.id;
                input.onchange = () => {
                    sandbox.updateCompilerSetting(optSummary.id, input.checked);
                };
                label.htmlFor = input.id;
                li.appendChild(input);
                li.appendChild(label);
                ol.appendChild(li);
            });
            categoryDiv.appendChild(header);
            categoryDiv.appendChild(ol);
            container.appendChild(categoryDiv);
        });
        const dropdownContainer = document.getElementById("compiler-dropdowns");
        const target = optionsSummary.find(sum => sum.id === "target");
        const targetSwitch = createSelect(target.display, "target", target.oneliner, sandbox, monaco.languages.typescript.ScriptTarget);
        dropdownContainer.appendChild(targetSwitch);
        const jsx = optionsSummary.find(sum => sum.id === "jsx");
        const jsxSwitch = createSelect(jsx.display, "jsx", jsx.oneliner, sandbox, monaco.languages.typescript.JsxEmit);
        dropdownContainer.appendChild(jsxSwitch);
        const modSum = optionsSummary.find(sum => sum.id === "module");
        const moduleSwitch = createSelect(modSum.display, "module", modSum.oneliner, sandbox, monaco.languages.typescript.ModuleKind);
        dropdownContainer.appendChild(moduleSwitch);
    };
    exports.createConfigDropdown = createConfigDropdown;
    const updateConfigDropdownForCompilerOptions = (sandbox, monaco) => {
        const compilerOpts = sandbox.getCompilerOptions();
        const boolOptions = Object.keys(compilerOpts).filter(k => typeof compilerOpts[k] === "boolean");
        boolOptions.forEach(opt => {
            const inputID = "option-" + opt;
            const input = document.getElementById(inputID);
            input.checked = !!compilerOpts[opt];
        });
        const compilerIDToMaps = {
            module: monaco.languages.typescript.ModuleKind,
            jsx: monaco.languages.typescript.JsxEmit,
            target: monaco.languages.typescript.ScriptTarget,
        };
        Object.keys(compilerIDToMaps).forEach(flagID => {
            const input = document.getElementById("compiler-select-" + flagID);
            const currentValue = compilerOpts[flagID];
            const map = compilerIDToMaps[flagID];
            // @ts-ignore
            const realValue = map[currentValue];
            if (!realValue)
                return;
            // @ts-ignore
            for (const option of input.children) {
                option.selected = option.value.toLowerCase() === realValue.toLowerCase();
            }
        });
    };
    exports.updateConfigDropdownForCompilerOptions = updateConfigDropdownForCompilerOptions;
    const createSelect = (title, id, blurb, sandbox, option) => {
        const label = document.createElement("label");
        const textToDescribe = document.createElement("span");
        textToDescribe.textContent = title + ":";
        label.appendChild(textToDescribe);
        const select = document.createElement("select");
        select.id = "compiler-select-" + id;
        label.appendChild(select);
        select.onchange = () => {
            const value = select.value; // the human string
            const compilerIndex = option[value];
            sandbox.updateCompilerSetting(id, compilerIndex);
        };
        Object.keys(option)
            .filter(key => isNaN(Number(key)))
            .forEach(key => {
            // hide Latest
            if (key === "Latest")
                return;
            const option = document.createElement("option");
            option.value = key;
            option.text = key;
            select.appendChild(option);
        });
        const span = document.createElement("span");
        span.textContent = blurb;
        span.classList.add("compiler-flag-blurb");
        label.appendChild(span);
        return label;
    };
    const setupJSONToggleForConfig = (sandbox) => { };
    exports.setupJSONToggleForConfig = setupJSONToggleForConfig;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlQ29uZmlnRHJvcGRvd24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wbGF5Z3JvdW5kL3NyYy9jcmVhdGVDb25maWdEcm9wZG93bi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0lBY08sTUFBTSxvQkFBb0IsR0FBRyxDQUFDLE9BQWdCLEVBQUUsTUFBYyxFQUFFLEVBQUU7UUFDdkUsTUFBTSxlQUFlLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBRSxDQUFBO1FBQ3BFLE1BQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDL0MsU0FBUyxDQUFDLEVBQUUsR0FBRywyQkFBMkIsQ0FBQTtRQUMxQyxlQUFlLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBRXRDLE1BQU0sWUFBWSxHQUFHLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxDQUFBO1FBQ2pELE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxZQUFZLENBQUMsQ0FBQyxDQUFDLEtBQUssU0FBUyxDQUFDLENBQUE7UUFFL0YseUNBQXlDO1FBQ3pDLE1BQU0sV0FBVyxHQUFHLEVBQWlFLENBQUE7UUFDckYsV0FBVyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUMxQixNQUFNLE9BQU8sR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsS0FBSyxLQUFLLEdBQUcsQ0FBQyxFQUFFLENBQUUsQ0FBQTtZQUU3RCxNQUFNLGdCQUFnQixHQUFHLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUE7WUFDeEQsSUFBSSxDQUFDLGdCQUFnQjtnQkFBRSxXQUFXLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtZQUUzRCxX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WUFFNUIsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQTtZQUMvQyxNQUFNLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQTtZQUNsQixNQUFNLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQTtZQUVqQixNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1FBQzVCLENBQUMsQ0FBQyxDQUFBO1FBRUosTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUMzQyxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQTtRQUN4QixJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO1FBQ3pDLEtBQUssQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUE7UUFFdkIsT0FBTyxLQUFLLENBQUE7SUFDZCxDQUFDLENBQUE7SUFFTSxNQUFNLHdCQUF3QixHQUFHLENBQUMsT0FBZ0IsRUFBRSxFQUFFLEdBQUUsQ0FBQyxDQUFBO0lBQW5ELFFBQUEsd0JBQXdCLDRCQUEyQiIsInNvdXJjZXNDb250ZW50IjpbInR5cGUgU2FuZGJveCA9IGltcG9ydChcInR5cGVzY3JpcHQtc2FuZGJveFwiKS5TYW5kYm94XG50eXBlIE1vbmFjbyA9IHR5cGVvZiBpbXBvcnQoXCJtb25hY28tZWRpdG9yXCIpXG5cbnR5cGUgT3B0aW9uc1N1bW1hcnkgPSB7XG4gIGRpc3BsYXk6IHN0cmluZ1xuICBvbmVsaW5lcjogc3RyaW5nXG4gIGlkOiBzdHJpbmdcbiAgY2F0ZWdvcnlJRDogc3RyaW5nXG4gIGNhdGVnb3J5RGlzcGxheTogc3RyaW5nXG59XG5cbi8vIFRoaXMgaXMgd2hlcmUgYWxsIHRoZSBsb2NhbGl6ZWQgZGVzY3JpcHRpb25zIGNvbWUgZnJvbVxuZGVjbGFyZSBjb25zdCBvcHRpb25zU3VtbWFyeTogT3B0aW9uc1N1bW1hcnlbXVxuXG5leHBvcnQgY29uc3QgY3JlYXRlQ29uZmlnRHJvcGRvd24gPSAoc2FuZGJveDogU2FuZGJveCwgbW9uYWNvOiBNb25hY28pID0+IHtcbiAgY29uc3QgY29uZmlnQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb25maWctY29udGFpbmVyXCIpIVxuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gIGNvbnRhaW5lci5pZCA9IFwiYm9vbGVhbi1vcHRpb25zLWNvbnRhaW5lclwiXG4gIGNvbmZpZ0NvbnRhaW5lci5hcHBlbmRDaGlsZChjb250YWluZXIpXG5cbiAgY29uc3QgY29tcGlsZXJPcHRzID0gc2FuZGJveC5nZXRDb21waWxlck9wdGlvbnMoKVxuICBjb25zdCBib29sT3B0aW9ucyA9IE9iamVjdC5rZXlzKGNvbXBpbGVyT3B0cykuZmlsdGVyKGsgPT4gdHlwZW9mIGNvbXBpbGVyT3B0c1trXSA9PT0gXCJib29sZWFuXCIpXG5cbiAgLy8gd2Ugd2FudCB0byBtYWtlIHNlY3Rpb25zIG9mIGNhdGVnb3JpZXNcbiAgY29uc3QgY2F0ZWdvcnlNYXAgPSB7fSBhcyB7IFtjYXRlZ29yeTogc3RyaW5nXTogeyBbb3B0SUQ6IHN0cmluZ106IE9wdGlvbnNTdW1tYXJ5IH0gfVxuICBib29sT3B0aW9ucy5mb3JFYWNoKG9wdElEID0+IHtcbiAgICBjb25zdCBzdW1tYXJ5ID0gb3B0aW9uc1N1bW1hcnkuZmluZChzdW0gPT4gb3B0SUQgPT09IHN1bS5pZCkhXG5cbiAgICBjb25zdCBleGlzdGluZ0NhdGVnb3J5ID0gY2F0ZWdvcnlNYXBbc3VtbWFyeS5jYXRlZ29yeUlEXVxuICAgIGlmICghZXhpc3RpbmdDYXRlZ29yeSkgY2F0ZWdvcnlNYXBbc3VtbWFyeS5jYXRlZ29yeUlEXSA9IHt9XG5cbiAgICBjYXRlZ29yeU1hcFtzdW1tYXJ5LmNhdGVnb3J5SURdW29wdElEXSA9IHN1bW1hcnlcbiAgfSlcblxuICBPYmplY3Qua2V5cyhjYXRlZ29yeU1hcCkuZm9yRWFjaChjYXRlZ29yeUlEID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDRcIilcbiAgICBjb25zdCBvbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvbFwiKVxuXG4gICAgT2JqZWN0LmtleXMoY2F0ZWdvcnlNYXBbY2F0ZWdvcnlJRF0pLmZvckVhY2gob3B0SUQgPT4ge1xuICAgICAgY29uc3Qgb3B0U3VtbWFyeSA9IGNhdGVnb3J5TWFwW2NhdGVnb3J5SURdW29wdElEXVxuICAgICAgaGVhZGVyLnRleHRDb250ZW50ID0gb3B0U3VtbWFyeS5jYXRlZ29yeURpc3BsYXlcblxuICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIilcbiAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpXG4gICAgICBsYWJlbC5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIlxuICAgICAgbGFiZWwuc3R5bGUud2lkdGggPSBcIjEwMCVcIlxuXG4gICAgICBjb25zdCBzdmcgPSBgPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIj8+PHN2ZyB3aWR0aD1cIjIwcHhcIiBoZWlnaHQ9XCIyMHB4XCIgdmlld0JveD1cIjAgMCAyMCAyMFwiIHZlcnNpb249XCIxLjFcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgeG1sbnM6eGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCI+XG4gICAgICAgICAgPGcgc3Ryb2tlPVwibm9uZVwiIHN0cm9rZS13aWR0aD1cIjFcIiBmaWxsPVwibm9uZVwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIj5cbiAgICAgICAgICAgIDxjaXJjbGUgc3Ryb2tlPVwiIzBCNkY1N1wiIGN4PVwiMTBcIiBjeT1cIjEwXCIgcj1cIjlcIj48L2NpcmNsZT5cbiAgICAgICAgICAgIDxwYXRoIGQ9XCJNOS45OTU5ODM5NCw2IEMxMC4yMDQ4MTkzLDYgMTAuNDI0MzY0MSw1LjkxNzAwMTM0IDEwLjY1NDYxODUsNS43NTEwMDQwMiBDMTAuODg0ODcyOCw1LjU4NTAwNjY5IDExLDUuMzM2MDEwNzEgMTEsNS4wMDQwMTYwNiBDMTEsNC42NjY2NjY2NyAxMC44ODQ4NzI4LDQuNDE0OTkzMzEgMTAuNjU0NjE4NSw0LjI0ODk5NTk4IEMxMC40MjQzNjQxLDQuMDgyOTk4NjYgMTAuMjA0ODE5Myw0IDkuOTk1OTgzOTQsNCBDOS43OTI1MDMzNSw0IDkuNTc1NjM1ODgsNC4wODI5OTg2NiA5LjM0NTM4MTUzLDQuMjQ4OTk1OTggQzkuMTE1MTI3MTgsNC40MTQ5OTMzMSA5LDQuNjY2NjY2NjcgOSw1LjAwNDAxNjA2IEM5LDUuMzM2MDEwNzEgOS4xMTUxMjcxOCw1LjU4NTAwNjY5IDkuMzQ1MzgxNTMsNS43NTEwMDQwMiBDOS41NzU2MzU4OCw1LjkxNzAwMTM0IDkuNzkyNTAzMzUsNiA5Ljk5NTk4Mzk0LDYgWiBNMTAuNjg3NzMyMywxNiBMMTAuNjg3NzMyMywxNC44ODk4ODM2IEwxMC42ODc3MzIzLDggTDkuMzA0ODMyNzEsOCBMOS4zMDQ4MzI3MSw5LjExMDExNjM4IEw5LjMwNDgzMjcxLDE2IEwxMC42ODc3MzIzLDE2IFpcIiBmaWxsPVwiIzBCNkY1N1wiIGZpbGwtcnVsZT1cIm5vbnplcm9cIj48L3BhdGg+XG4gICAgICAgICAgPC9nPlxuICAgICAgPC9zdmc+YFxuICAgICAgbGFiZWwuaW5uZXJIVE1MID0gYDxzcGFuPiR7b3B0U3VtbWFyeS5pZH08L3NwYW4+PGEgaHJlZj0nLi4vdHNjb25maWcjJHtvcHRTdW1tYXJ5LmlkfScgY2xhc3M9J2NvbXBpbGVyX2luZm9fbGluaycgYWx0PSdMb29rIHVwICR7b3B0U3VtbWFyeS5pZH0gaW4gdGhlIFRTQ29uZmlnIFJlZmVyZW5jZSc+JHtzdmd9PC9hPjxici8+JHtvcHRTdW1tYXJ5Lm9uZWxpbmVyfWBcblxuICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIilcbiAgICAgIGlucHV0LnZhbHVlID0gb3B0U3VtbWFyeS5pZFxuICAgICAgaW5wdXQudHlwZSA9IFwiY2hlY2tib3hcIlxuICAgICAgaW5wdXQubmFtZSA9IG9wdFN1bW1hcnkuaWRcbiAgICAgIGlucHV0LmlkID0gXCJvcHRpb24tXCIgKyBvcHRTdW1tYXJ5LmlkXG5cbiAgICAgIGlucHV0Lm9uY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICBzYW5kYm94LnVwZGF0ZUNvbXBpbGVyU2V0dGluZyhvcHRTdW1tYXJ5LmlkLCBpbnB1dC5jaGVja2VkKVxuICAgICAgfVxuXG4gICAgICBsYWJlbC5odG1sRm9yID0gaW5wdXQuaWRcblxuICAgICAgbGkuYXBwZW5kQ2hpbGQoaW5wdXQpXG4gICAgICBsaS5hcHBlbmRDaGlsZChsYWJlbClcbiAgICAgIG9sLmFwcGVuZENoaWxkKGxpKVxuICAgIH0pXG5cbiAgICBjYXRlZ29yeURpdi5hcHBlbmRDaGlsZChoZWFkZXIpXG4gICAgY2F0ZWdvcnlEaXYuYXBwZW5kQ2hpbGQob2wpXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNhdGVnb3J5RGl2KVxuICB9KVxuXG4gIGNvbnN0IGRyb3Bkb3duQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21waWxlci1kcm9wZG93bnNcIikhXG5cbiAgY29uc3QgdGFyZ2V0ID0gb3B0aW9uc1N1bW1hcnkuZmluZChzdW0gPT4gc3VtLmlkID09PSBcInRhcmdldFwiKSFcbiAgY29uc3QgdGFyZ2V0U3dpdGNoID0gY3JlYXRlU2VsZWN0KFxuICAgIHRhcmdldC5kaXNwbGF5LFxuICAgIFwidGFyZ2V0XCIsXG4gICAgdGFyZ2V0Lm9uZWxpbmVyLFxuICAgIHNhbmRib3gsXG4gICAgbW9uYWNvLmxhbmd1YWdlcy50eXBlc2NyaXB0LlNjcmlwdFRhcmdldFxuICApXG4gIGRyb3Bkb3duQ29udGFpbmVyLmFwcGVuZENoaWxkKHRhcmdldFN3aXRjaClcblxuICBjb25zdCBqc3ggPSBvcHRpb25zU3VtbWFyeS5maW5kKHN1bSA9PiBzdW0uaWQgPT09IFwianN4XCIpIVxuICBjb25zdCBqc3hTd2l0Y2ggPSBjcmVhdGVTZWxlY3QoanN4LmRpc3BsYXksIFwianN4XCIsIGpzeC5vbmVsaW5lciwgc2FuZGJveCwgbW9uYWNvLmxhbmd1YWdlcy50eXBlc2NyaXB0LkpzeEVtaXQpXG4gIGRyb3Bkb3duQ29udGFpbmVyLmFwcGVuZENoaWxkKGpzeFN3aXRjaClcblxuICBjb25zdCBtb2RTdW0gPSBvcHRpb25zU3VtbWFyeS5maW5kKHN1bSA9PiBzdW0uaWQgPT09IFwibW9kdWxlXCIpIVxuICBjb25zdCBtb2R1bGVTd2l0Y2ggPSBjcmVhdGVTZWxlY3QoXG4gICAgbW9kU3VtLmRpc3BsYXksXG4gICAgXCJtb2R1bGVcIixcbiAgICBtb2RTdW0ub25lbGluZXIsXG4gICAgc2FuZGJveCxcbiAgICBtb25hY28ubGFuZ3VhZ2VzLnR5cGVzY3JpcHQuTW9kdWxlS2luZFxuICApXG4gIGRyb3Bkb3duQ29udGFpbmVyLmFwcGVuZENoaWxkKG1vZHVsZVN3aXRjaClcbn1cblxuZXhwb3J0IGNvbnN0IHVwZGF0ZUNvbmZpZ0Ryb3Bkb3duRm9yQ29tcGlsZXJPcHRpb25zID0gKHNhbmRib3g6IFNhbmRib3gsIG1vbmFjbzogTW9uYWNvKSA9PiB7XG4gIGNvbnN0IGNvbXBpbGVyT3B0cyA9IHNhbmRib3guZ2V0Q29tcGlsZXJPcHRpb25zKClcbiAgY29uc3QgYm9vbE9wdGlvbnMgPSBPYmplY3Qua2V5cyhjb21waWxlck9wdHMpLmZpbHRlcihrID0+IHR5cGVvZiBjb21waWxlck9wdHNba10gPT09IFwiYm9vbGVhblwiKVxuXG4gIGJvb2xPcHRpb25zLmZvckVhY2gob3B0ID0+IHtcbiAgICBjb25zdCBpbnB1dElEID0gXCJvcHRpb24tXCIgKyBvcHRcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0SUQpIGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICBpbnB1dC5jaGVja2VkID0gISFjb21waWxlck9wdHNbb3B0XVxuICB9KVxuXG4gIGNvbnN0IGNvbXBpbGVySURUb01hcHM6IGFueSA9IHtcbiAgICBtb2R1bGU6IG1vbmFjby5sYW5ndWFnZXMudHlwZXNjcmlwdC5Nb2R1bGVLaW5kLFxuICAgIGpzeDogbW9uYWNvLmxhbmd1YWdlcy50eXBlc2NyaXB0LkpzeEVtaXQsXG4gICAgdGFyZ2V0OiBtb25hY28ubGFuZ3VhZ2VzLnR5cGVzY3JpcHQuU2NyaXB0VGFyZ2V0LFxuICB9XG5cbiAgT2JqZWN0LmtleXMoY29tcGlsZXJJRFRvTWFwcykuZm9yRWFjaChmbGFnSUQgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21waWxlci1zZWxlY3QtXCIgKyBmbGFnSUQpIGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBjb21waWxlck9wdHNbZmxhZ0lEXVxuICAgIGNvbnN0IG1hcCA9IGNvbXBpbGVySURUb01hcHNbZmxhZ0lEXVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCByZWFsVmFsdWUgPSBtYXBbY3VycmVudFZhbHVlXVxuICAgIGlmICghcmVhbFZhbHVlKSByZXR1cm5cblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBmb3IgKGNvbnN0IG9wdGlvbiBvZiBpbnB1dC5jaGlsZHJlbikge1xuICAgICAgb3B0aW9uLnNlbGVjdGVkID0gb3B0aW9uLnZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IHJlYWxWYWx1ZS50b0xvd2VyQ2FzZSgpXG4gICAgfVxuICB9KVxufVxuXG5jb25zdCBjcmVhdGVTZWxlY3QgPSAodGl0bGU6IHN0cmluZywgaWQ6IHN0cmluZywgYmx1cmI6IHN0cmluZywgc2FuZGJveDogU2FuZGJveCwgb3B0aW9uOiBhbnkpID0+IHtcbiAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIilcbiAgY29uc3QgdGV4dFRvRGVzY3JpYmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKVxuICB0ZXh0VG9EZXNjcmliZS50ZXh0Q29udGVudCA9IHRpdGxlICsgXCI6XCJcbiAgbGFiZWwuYXBwZW5kQ2hpbGQodGV4dFRvRGVzY3JpYmUpXG5cbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKVxuICBzZWxlY3QuaWQgPSBcImNvbXBpbGVyLXNlbGVjdC1cIiArIGlkXG4gIGxhYmVsLmFwcGVuZENoaWxkKHNlbGVjdClcblxuICBzZWxlY3Qub25jaGFuZ2UgPSAoKSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSBzZWxlY3QudmFsdWUgLy8gdGhlIGh1bWFuIHN0cmluZ1xuICAgIGNvbnN0IGNvbXBpbGVySW5kZXggPSBvcHRpb25bdmFsdWVdXG4gICAgc2FuZGJveC51cGRhdGVDb21waWxlclNldHRpbmcoaWQsIGNvbXBpbGVySW5kZXgpXG4gIH1cblxuICBPYmplY3Qua2V5cyhvcHRpb24pXG4gICAgLmZpbHRlcihrZXkgPT4gaXNOYU4oTnVtYmVyKGtleSkpKVxuICAgIC5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAvLyBoaWRlIExhdGVzdFxuICAgICAgaWYgKGtleSA9PT0gXCJMYXRlc3RcIikgcmV0dXJuXG5cbiAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIilcbiAgICAgIG9wdGlvbi52YWx1ZSA9IGtleVxuICAgICAgb3B0aW9uLnRleHQgPSBrZXlcblxuICAgICAgc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbilcbiAgICB9KVxuXG4gIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKVxuICBzcGFuLnRleHRDb250ZW50ID0gYmx1cmJcbiAgc3Bhbi5jbGFzc0xpc3QuYWRkKFwiY29tcGlsZXItZmxhZy1ibHVyYlwiKVxuICBsYWJlbC5hcHBlbmRDaGlsZChzcGFuKVxuXG4gIHJldHVybiBsYWJlbFxufVxuXG5leHBvcnQgY29uc3Qgc2V0dXBKU09OVG9nZ2xlRm9yQ29uZmlnID0gKHNhbmRib3g6IFNhbmRib3gpID0+IHt9XG4iXX0=